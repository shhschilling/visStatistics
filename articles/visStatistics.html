<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>visStatistics • visStatistics</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="visStatistics">
<meta property="og:description" content="visStatistics">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">visStatistics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/visStatistics.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/shhschilling/visStatistics/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="visStatistics_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>visStatistics</h1>
                        <h4 class="author">Sabine Schilling</h4>
            
            <h4 class="date">2021-09-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/shhschilling/visStatistics/blob/master/vignettes/visStatistics.Rmd"><code>vignettes/visStatistics.Rmd</code></a></small>
      <div class="hidden name"><code>visStatistics.Rmd</code></div>

    </div>

    
    
<style type="text/css">
  body{
  font-size: 12pt;
}
</style>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://shhschilling.github.io/visStatistics">visStatistics</a></span><span class="op">)</span></code></pre></div>
<!-- https://pkgdown.r-lib.org/ 
shows how to publish the cod -->
<!-- Unnumbered section -->
<div id="abstract" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#abstract" class="anchor"></a>Abstract</h1>
<p>The R package <code>visStatistics</code> provides means to quickly visualize and analyze raw data.</p>
<p>Based on a decision tree it picks the statistical hypothesis test with the highest statistical power between the dependent variable (response) named <code>varsample</code> and the independent variable (feature) named <code>varfactor</code> in a <code>data.frame</code> named <code>dataframe</code>. A minimal function call has the structure:</p>
<p><code><a href="../reference/visstat.html">visstat(dataframe,varsample,varfactor)</a></code></p>
<p>Data in the provided <code>dataframe</code> must be structured column wise, where <code>varsample</code> and <code>varfactor</code> are the character strings of the column names of the dependent and independent variable respectively.</p>
<p>The choice of statistical tests performed by the core function visstat() depends on the type of the data (quantitative numerical or qualitative categorical), the number of levels whilst dealing with categorical data and the data distributions.</p>
<p><code>visStatistics</code> offers a fully automated workflow that is especially suited for browser-based interfaces to server-based deployments of R. It has been successfully applied for unbiased analysis of medical raw data.</p>
<p>The remainder of this vignette focuses on the the algorithm underlying the decision tree of <code>vistat()</code>, whilst a call to <code><a href="../reference/visstat.html">?visstat</a></code> documents all parameter settings of the function.</p>
</div>
<div id="comparing-means-and-medians" class="section level1">
<h1 class="hasAnchor">
<a href="#comparing-means-and-medians" class="anchor"></a>Comparing means and medians</h1>
<p>If the feature <code>varfactor</code> is a categorical variable (in R a <code>factor</code>) with two or more levels and the response <code>varsample</code> is numeric, tests are applied.to compare the means or medians of the samples.</p>
<div id="two-sample-tests-welchs-t-test-or-wilcoxon-rank-sum-test" class="section level2">
<h2 class="hasAnchor">
<a href="#two-sample-tests-welchs-t-test-or-wilcoxon-rank-sum-test" class="anchor"></a>Two sample tests: Welch’s t-Test or Wilcoxon rank sum test</h2>
<p>If the independent variable <code>varfactor</code> has two levels and the dependent variable <code>varsample</code> is numeric, either Welch’s t-Test or the Wilcoxon rank sum test are performed. The choice follows the algorithm:</p>
<ul>
<li><p>If the sample size for both levels is bigger than 100, perform always the <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> <span class="citation">(Lumley et al. 2002)</span>.</p></li>
<li>
<p>If the sample size of at least one of the levels is smaller than 100, checks first for normality of both distributions with the Shapiro-Wilk Normality Test (<code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test()</a></code>):</p>
<ul>
<li><p>If the p-values in the <code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test()</a></code> of both samples are bigger than the error probability <code>1-conf.level</code>,Welch’s t-Test (<code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code>) is executed.</p></li>
<li><p>If the p-values of both samples in the <code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test()</a></code> are smaller than the error probability <code>1-conf.level</code>, a Wilcoxon rank sum test (<code><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test()</a></code>) is executed.</p></li>
</ul>
</li>
</ul>
<p>The graphical representation consists of box plots overlayed with jitter plots showing each data point. In the case of the <code>t-test.()),  additionally the</code>conf.level`*100 % -confidence intervals are shown.The test statistics of the chosen test as well as the summary statistics of the generated boxplots is generated and returned as a list.</p>
<div id="examples" class="section level3">
<h3 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h3>
<div id="welchs-t-test-calling-t-test" class="section level4">
<h4 class="hasAnchor">
<a href="#welchs-t-test-calling-t-test" class="anchor"></a>Welch’s t-test calling t.test()</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span><span class="op">)</span>
<span class="va">ttestStatistics</span> <span class="op">=</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">mtcars</span>,<span class="st">"mpg"</span>,<span class="st">"am"</span><span class="op">)</span> </code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-2-1.png" width="100%"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># uncomenting the next line prints out test statistics </span>
<span class="co"># ttestStatistics</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Increasing the confidence level</span>
<span class="va">ttestStatistics</span> <span class="op">=</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">mtcars</span>,<span class="st">"mpg"</span>,<span class="st">"am"</span>,conf.level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span> </code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-3-1.png" width="100%"></p>
</div>
<div id="wilcoxon-rank-sum-test-calling-wilcox-test" class="section level4">
<h4 class="hasAnchor">
<a href="#wilcoxon-rank-sum-test-calling-wilcox-test" class="anchor"></a>Wilcoxon rank sum test (calling wilcox.test())</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">grades_gender</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
Sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Girl"</span>, <span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Boy"</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
Grade <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">19.3</span>, <span class="fl">18.1</span>, <span class="fl">15.2</span>, <span class="fl">18.3</span>, <span class="fl">7.9</span>, <span class="fl">6.2</span>, <span class="fl">19.4</span>, 
            <span class="fl">20.3</span>, <span class="fl">9.3</span>, <span class="fl">11.3</span>, <span class="fl">18.2</span>,<span class="fl">17.5</span>,<span class="fl">10.2</span>,<span class="fl">20.1</span>,<span class="fl">13.3</span>,<span class="fl">17.2</span>,<span class="fl">15.1</span>,<span class="fl">16.2</span>,<span class="fl">17.3</span>,
            <span class="fl">16.5</span>, <span class="fl">5.1</span>, <span class="fl">15.3</span>, <span class="fl">17.1</span>, <span class="fl">14.8</span>, <span class="fl">15.4</span>, <span class="fl">14.4</span>, <span class="fl">7.5</span>, <span class="fl">15.5</span>, <span class="fl">6.0</span>,<span class="fl">17.4</span>,
            <span class="fl">7.3</span>, <span class="fl">14.3</span>,<span class="fl">13.5</span>,<span class="fl">8.0</span>,<span class="fl">19.5</span>,<span class="fl">13.4</span>,<span class="fl">17.9</span>,<span class="fl">17.7</span>,<span class="fl">16.4</span>,<span class="fl">15.6</span><span class="op">)</span><span class="op">)</span>

<span class="va">wilcoxonStatistics</span> <span class="op">=</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">grades_gender</span>,<span class="st">"Grade"</span>, <span class="st">"Sex"</span><span class="op">)</span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
</div>
</div>
</div>
<div id="aov" class="section level2">
<h2 class="hasAnchor">
<a href="#aov" class="anchor"></a>More than two samples: One Way Test and ANOVA or Kruskal-Wallis-Test</h2>
<p>If the categorical (<code>factor</code>) variable <code>varfactor</code> has more than two levels and the response <code>varsample</code> is numeric, the underlying assumptions of the analysis of variance, normality of the standardized residuals and homoscedacity, are checked by the function <code>vis_anova_asumptions()</code>.</p>
<div id="residual-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#residual-analysis" class="anchor"></a>Residual analysis</h3>
<p>It checks for the normality of the standardised residuals of the analysis of variance (ANOVA) fit generated by the function <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> . To do so it applies both the Shapiro-Wilk-test <code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test()</a></code> and the Anderson-Darling-Test <code>ad.test()</code> on the standardized residuals. Furthermore the data is graphically analysed by plotting the standardized residuals versus the fitted mean values of the linear model for each level of <code>varfactor</code>. Additionally the normal QQ plot of the standardized residuals is generated.</p>
</div>
<div id="check-for-homogenity-of-variances-in-each-level-bartlett-test" class="section level3">
<h3 class="hasAnchor">
<a href="#check-for-homogenity-of-variances-in-each-level-bartlett-test" class="anchor"></a>Check for homogenity of variances in each level: Bartlett test</h3>
<p>Both <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> and <code><a href="https://rdrr.io/r/stats/oneway.test.html">oneway.test()</a></code> check, whether two or more samples from normal distributions have the same mean. Whereas <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> requires homogeneity of variances in each level (group), the <code><a href="https://rdrr.io/r/stats/oneway.test.html">oneway.test()</a></code> does not assume that the variances in each group are necessarily equal. Homoscedacity is tested with the <code><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test()</a></code>. It performs Bartlett’s test of the null hypothesis that the variances in each of the levels are the same.</p>
</div>
<div id="sidak" class="section level3">
<h3 class="hasAnchor">
<a href="#sidak" class="anchor"></a>One Way Test and ANOVA</h3>
<p>Depending on the p-value of the <code><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test()</a></code> the appropriate test is shown in the title:</p>
<ul>
<li><p>If the p-value of the <code><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test()</a></code> is bigger than <code>1-conf.level</code>, we can assume homogeneity of variances in each level (group) and the p-values of <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> is displayed.</p></li>
<li><p>Otherwise homoscedacity can not be assumed and the p-value of <code><a href="https://rdrr.io/r/stats/oneway.test.html">oneway.test()</a></code> is reported.</p></li>
</ul>
<p>To generate Sidak corrected confidence intervals, we calculate the corrected probability of error for the construction of M confidence intervals, <span class="math display">\[\alpha_{Sidak}=1-conf.int^{1/M}.\]</span> Here, <span class="math inline">\(M\)</span> is the number of levels of the independent variable <span class="citation">(Šidák 1967)</span>. Inserting the corrected <span class="math inline">\(\alpha_{Sidak}\)</span> into the standard formula for confidence intervals we obtain the Sidak corrected boundaries of the confidene interval <span class="math display">\[ \left[{{\overline {x}}-t_{\left(1-{\frac {\alpha_{Sidak} }{2}};n-1\right)}{\frac {s}{\sqrt {n}}}\ ;\ {\overline {x}}+t_{\left(1-{\frac {\alpha_{Sidak} }{2}};n-1\right)}{\frac {s}{\sqrt {n}}}}\right],
\]</span></p>
<p>where <span class="math inline">\(\overline {x}\)</span> is the mean, <span class="math inline">\(s\)</span> the standard deviation and <span class="math inline">\(n\)</span> the number of entries of each group (level).</p>
<p>Note that the current structure of <code><a href="../reference/visstat.html">visstat()</a></code> does not allow the study of interactions between the different levels of the independent variable.</p>
<div id="post-hoc-analysis-tukey-honest-significant-differences" class="section level4">
<h4 class="hasAnchor">
<a href="#post-hoc-analysis-tukey-honest-significant-differences" class="anchor"></a>Post-hoc analysis: Tukey Honest Significant Differences</h4>
<p>We use the Tukey Honest Significant Differences <code><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD()</a></code> to create a set of confidence intervals on the differences between the means of the levels of a factor with the specified family-wise probability <code>conf.level</code>. This list of confidence intervals accompanied by the adjusted p-values is returned. If the difference between two levels is significant at the given <code>conf.level</code>, the displayed letters at the bottom of the graph between the two levels will differ. Note that the Tukey HSD requires homoscedacity of the samples. In a future revision of <code>visStatistics</code> an approriate post-hoc test for non homogeneous data will be included.</p>
</div>
</div>
<div id="kruskal-wallis-test" class="section level3">
<h3 class="hasAnchor">
<a href="#kruskal-wallis-test" class="anchor"></a>Kruskal-Wallis-Test</h3>
<p>If the p-values of the standardized residuals calculated by <code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test()</a></code> or <code>ad.test()</code> are smaller than the error probability <code>1-conf.level</code>, a normal distribution of the residuals can not be assumed. In this case, <code><a href="../reference/visstat.html">visstat()</a></code> chooses a non-parametric alternative, the Kruskal-Wallis rank sum test. <code><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test()</a></code> tests the null that the medians are the same in each group (level). As post-hoc-analysis the pairwise Wilcoxon rank sum test <code><a href="https://rdrr.io/r/stats/pairwise.wilcox.test.html">pairwise.wilcox.test()</a></code> applying the default Holm method for multiple comparisons<span class="citation">(Holm 1979)</span> is used. If the Holm corrected p-value for a pair is smaller than <code>1-confint</code>, the green letters below the corresponding two box plots will differ. Otherwise the graphical representation of the Kruskal-Wallis test is analogue to the above described Wilcoxon rank sum test. A list with the test statistics of the Kruskal-Wallis rank sum test as well as the p-values of the pairwise comparisons adjusted by the Holm method is returned.</p>
</div>
<div id="examples-1" class="section level3">
<h3 class="hasAnchor">
<a href="#examples-1" class="anchor"></a>Examples</h3>
<p>The <code>npk</code> data sets reports the yield of peas in pounds/block on 6 blocks. <!-- where either nitrogen (N), phosphate (P) or potassium (K) was spread. --></p>
<div id="one-way-test" class="section level4">
<h4 class="hasAnchor">
<a href="#one-way-test" class="anchor"></a>One way test</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="va">oneway_npk</span> <span class="op">=</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">npk</span>,<span class="st">"yield"</span>,<span class="st">"block"</span><span class="op">)</span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-5-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-5-2.png" width="100%"></p>
<p>The post-hoc analysis with <code><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD()</a></code> reveals no significant difference between the yield in all blocks (all green letters are the same). #### ANOVA</p>
<p>To stabilize the variance we transform the count data with the square root.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">InsectSprays_tr</span> <span class="op">=</span> <span class="va">InsectSprays</span>
<span class="va">InsectSprays_tr</span><span class="op">$</span><span class="va">count</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">InsectSprays</span><span class="op">$</span><span class="va">count</span><span class="op">)</span>
<span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">InsectSprays_tr</span>, <span class="st">"count"</span>, <span class="st">"spray"</span><span class="op">)</span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-6-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-6-2.png" width="100%"></p>
<p>In the above example the scatter plots of the standardized residuals, the QQ -plot and the p-values of both Shapiro-Wilk-test and Anderson-Darling tests are greater than the probability of error <span class="math inline">\(\alpha=0.05\)</span>. Therefore we can assume that the residuals are normally distributed. At the given confidence level the homogeneity of variances can not be assumed (<span class="math inline">\(p &lt;\alpha\)</span> as calculated with the <code><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test()</a></code>), and the p-value of the <code><a href="https://rdrr.io/r/stats/oneway.test.html">oneway.test()</a></code> is displayed.</p>
</div>
<div id="kruskal-wallis-rank-sum-test" class="section level4">
<h4 class="hasAnchor">
<a href="#kruskal-wallis-rank-sum-test" class="anchor"></a>Kruskal-Wallis rank sum test</h4>
<p>The iris data set gives the measurement of the petal width in cm for three different iris species.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">iris</span>,<span class="st">"Petal.Width"</span>, <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-7-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-7-2.png" width="100%"></p>
<p>In the iris data example, both the graphical analysis by the scatter plots of the standardized residuals and the QQ -plot as well as the p-values of Shapiro-Wilk-test and Anderson-Darling test suggest that we can not assume that the residuals are normally distributed. Therefore <code>visstat</code> switches to the non parametric alternative <code><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test()</a></code>.</p>
</div>
</div>
</div>
</div>
<div id="linear-regression" class="section level1">
<h1 class="hasAnchor">
<a href="#linear-regression" class="anchor"></a>Linear Regression</h1>
<p>If the feature <code>varfactor</code> and the response <code>varsample</code> have only one level of type <code>numerical</code> or <code>integer</code>, <code><a href="../reference/visstat.html">visstat()</a></code> performs a simple linear regression</p>
<div id="residual-analysis-1" class="section level2">
<h2 class="hasAnchor">
<a href="#residual-analysis-1" class="anchor"></a>Residual analysis</h2>
<p><code>visstat</code> checks the normal distribution of the standardized residuals derived from <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> both graphically and with the Shapiro-Wilk- and Anderson-Test (analogue to section @ref(aov) ). If the p-values of the null that the standardized residuals are normally distributed of both Shapiro-Wilk and Anderson-Test are greater than <code>1-conf.int</code>, the title of the residual plot will display the message “Requirements regression not met”.</p>
<p>Independent of the residual analysis outcome, <code><a href="../reference/visstat.html">visstat()</a></code>` performs in the subsequent step the regression itself. The title of the graphical output lists the chosen confidence level <code>conf.level</code>, the regression parameter accompanied by their confidence levels and p-values as well as the adjusted <span class="math inline">\(R^2\)</span>. The graph shows the raw data, the regression line and both the confidence and prediction bands corresponding to the chosen <code>conf.level</code>. The function returns a list with the test statistics of the linear regression, the p-values of the normality tests of the standardized residuals and the pointwise estimates of the confidence and prediction band.</p>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<div id="cars" class="section level3">
<h3 class="hasAnchor">
<a href="#cars" class="anchor"></a>cars</h3>
<p>The cars data set reports the speed in mph of cars and the distances (dist) in ft taken to stop.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linreg_cars</span> <span class="op">=</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">cars</span>,<span class="st">"dist"</span>,<span class="st">"speed"</span><span class="op">)</span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-8-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-8-2.png" width="100%"></p>
<p>Increasing the confidence level <code>conf.level</code> from the default 0.95 to 0.99 leads two wider confidence and prediction bands:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linreg_cars</span> <span class="op">=</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">cars</span>,<span class="st">"dist"</span>,<span class="st">"speed"</span>,conf.level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-9-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-9-2.png" width="100%"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Extract the test statistics </span>
<span class="va">linreg_cars</span><span class="op">$</span><span class="va">anderson_darling_test_residuals</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Anderson-Darling normality test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  rstandard(lm(y ~ x))</span>
<span class="co">#&gt; A = 0.8005, p-value = 0.03555</span>
<span class="va">linreg_cars</span><span class="op">$</span><span class="va">shapiro_test_residuals</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Shapiro-Wilk normality test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  rstandard(lm(y ~ x))</span>
<span class="co">#&gt; W = 0.94518, p-value = 0.0217</span></code></pre></div>
<p>The linear regression model explains 64% of the total variance of the dependent variables distance named “dist”. p-values greater than <code>conf.level</code> in both Anderson-Darling normality test and the Shapiro-Wilk test of the standardized residuals suggest that the normality assumption underlying the linear regression is met.</p>
</div>
<div id="trees" class="section level3">
<h3 class="hasAnchor">
<a href="#trees" class="anchor"></a>trees</h3>
<p>The trees data set provides measurements of the diameter (named “Girth”) in inches and height in feet of black cherry trees.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linreg_cars</span> <span class="op">=</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">trees</span>,<span class="st">"Height"</span>,<span class="st">"Girth"</span>,conf.level <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-10-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-10-2.png" width="100%"></p>
<p>Both the graphical analysis of the standardized residuals and p-values smaller than <code>conf.level</code> in the Anderson-Darling normality test and the Shapiro-Wilk test of the standardized residuals suggest that the condition of normally distributed residuals of the regression model is not met. Furthermore the linear regression model explains only 24% of the total variance of the dependent variables “Height” of the cherry trees. The user should might consider other regression models. This further tests are not provided by <code><a href="../reference/visstat.html">visstat()</a></code>.</p>
</div>
</div>
</div>
<div id="chi2--and-fisher-test" class="section level1">
<h1 class="hasAnchor">
<a href="#chi2--and-fisher-test" class="anchor"></a><span class="math inline">\({\chi}^2\)</span>- and Fisher Test</h1>
<p>If both the feature <code>varfactor</code> and the response are <code>varsample</code> are categorical of type <code>factor</code>, <code>visstat</code> performs a test for the independence of count data. Based on Cochran’s rule <span class="citation">(Cochran 1954)</span>, either a <span class="math inline">\({\chi}^2\)</span>- or a Fisher Test are performed: - If more than 20 percent of all cells have a count smaller than 5, <code><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test()</a></code> is performed and displayed, otherwise the <code>chisqu.test()</code>.</p>
<p>In both cases a grouped column charts with the p-value of the corresponding test in the title and a mosaic plot showing Pearson’s residuals (for details see documentation of function <code>mosaic()</code> in the <code>vcd</code> package ) are generated.</p>
<div id="transforming-contingency-tables" class="section level2">
<h2 class="hasAnchor">
<a href="#transforming-contingency-tables" class="anchor"></a>Transforming contingency tables</h2>
<p>Count data are often presented as multidimensional arrays, so called contingency tables, whereas <code><a href="../reference/visstat.html">visstat()</a></code> requires a <code>data.frame</code> with a column structure. Arrays can be transformed to this column wise structure with the helper function <code><a href="../reference/counts_to_cases.html">counts_to_cases()</a></code></p>
<div id="example-1" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1" class="anchor"></a>Example</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HairEyeColorDataFrame</span> <span class="op">=</span> <span class="fu"><a href="../reference/counts_to_cases.html">counts_to_cases</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">HairEyeColor</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
</div>
</div>
<div id="pearsons-chi-squared-test-and-mosaic-plot-with-pearson-residuals" class="section level2">
<h2 class="hasAnchor">
<a href="#pearsons-chi-squared-test-and-mosaic-plot-with-pearson-residuals" class="anchor"></a>Pearson’s Chi-squared test and mosaic plot with Pearson residuals</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HairEyeColorDataFrame</span> <span class="op">=</span> <span class="fu"><a href="../reference/counts_to_cases.html">counts_to_cases</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">HairEyeColor</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">HairEyeColorDataFrame</span>,<span class="st">"Hair"</span>,<span class="st">"Eye"</span><span class="op">)</span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-12-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-12-2.png" width="100%"></p>
</div>
<div id="fishers-exact-test-and-mosaic-plot-with-pearson-residuals" class="section level2">
<h2 class="hasAnchor">
<a href="#fishers-exact-test-and-mosaic-plot-with-pearson-residuals" class="anchor"></a>Fisher’s exact test and mosaic plot with Pearson residuals</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HairEyeColorMaleFisher</span> <span class="op">=</span> <span class="va">HairEyeColor</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span>
<span class="co">#slicing out a 2 x2 contingency table</span>
<span class="va">blackBrownHazelGreen</span> <span class="op">=</span> <span class="va">HairEyeColorMaleFisher</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>
<span class="va">blackBrownHazelGreen</span> <span class="op">=</span> <span class="fu"><a href="../reference/counts_to_cases.html">counts_to_cases</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">blackBrownHazelGreen</span><span class="op">)</span><span class="op">)</span>;
<span class="va">fisher_stats</span> <span class="op">=</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">blackBrownHazelGreen</span>,<span class="st">"Hair"</span>,<span class="st">"Eye"</span><span class="op">)</span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-13-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-13-2.png" width="100%"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># fisher_stats  #uncommenting prints out summary statistics</span></code></pre></div>
</div>
</div>
<div id="saving-the-graphical-output" class="section level1">
<h1 class="hasAnchor">
<a href="#saving-the-graphical-output" class="anchor"></a>Saving the graphical output</h1>
<p>The generated graphs can be saved in the file formats supported by <code>Cairo():</code> “png”, “jpeg”, “pdf”, “svg”, “ps” and “tiff”. In the following example we save the graphics files in the output format “png” to the <code>plotDirectory</code> <code><a href="https://rdrr.io/r/base/tempfile.html">tempdir()</a></code>. The applied naming convention of the graphics file reflects the chosen statistical test and the variable names.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">blackBrownHazelGreen</span>,<span class="st">"Hair"</span>,<span class="st">"Eye"</span>,graphicsoutput <span class="op">=</span> <span class="st">"png"</span>,plotDirectory <span class="op">=</span> 
          
          <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p>Remove the graphical output from <code>plotDirectory</code></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="https://rdrr.io/r/base/files.html">file.remove</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>,<span class="st">"chi_squared_or_fisher_Hair_Eye.png"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span>
 <span class="fu"><a href="https://rdrr.io/r/base/files.html">file.remove</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>,<span class="st">"mosaic_complete_Hair_Eye.png"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
</div>
<div id="overview-of-implemented-tests" class="section level1">
<h1 class="hasAnchor">
<a href="#overview-of-implemented-tests" class="anchor"></a>Overview of implemented tests</h1>
<p><code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code>, <code><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test()</a></code>, <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code>, <code><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test()</a></code>, <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>,<code><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test()</a></code>, <code>chisqu.test()</code></p>
<div id="implemented-tests-to-check-the-normal-distribution-of-standardized-residuals" class="section level2">
<h2 class="hasAnchor">
<a href="#implemented-tests-to-check-the-normal-distribution-of-standardized-residuals" class="anchor"></a>Implemented tests to check the normal distribution of standardized residuals</h2>
<p><code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test()</a></code> and <code>ad.test()</code></p>
</div>
<div id="implemented-post-hoc-tests" class="section level2">
<h2 class="hasAnchor">
<a href="#implemented-post-hoc-tests" class="anchor"></a>Implemented post-hoc tests</h2>
<p><code><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD()</a></code> for <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> and <code><a href="https://rdrr.io/r/stats/pairwise.wilcox.test.html">pairwise.wilcox.test()</a></code> for <code><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test()</a></code>.</p>
</div>
</div>
<div id="bibliography" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#bibliography" class="anchor"></a>Bibliography</h1>
<div id="refs" class="references">
<div id="ref-Cochran">
<p>Cochran, William G. and. 1954. “The combination of estimates from different experiments.” <em>Scandinavian Journal of Statistics</em> 10 (1): 101–20. <a href="https://doi.org/10.2307/3001666">https://doi.org/10.2307/3001666</a>.</p>
</div>
<div id="ref-Holm1979ASS">
<p>Holm, S. 1979. “A Simple Sequentially Rejective Multiple Test Procedure.” <em>Scandinavian Journal of Statistics</em> 6: 65–70.</p>
</div>
<div id="ref-Lumley2002dsa">
<p>Lumley, Thomas, Paula Diehr, Scott Emerson, and Lu Chen. 2002. “The importance of the normality assumption in large public health data sets.” <em>Annual Review of Public Health</em> 23: 151–69. <a href="https://doi.org/10.1146/annurev.publhealth.23.100901.140546">https://doi.org/10.1146/annurev.publhealth.23.100901.140546</a>.</p>
</div>
<div id="ref-Sidak">
<p>Šidák, Zbyněk. 1967. “Rectangular Confidence Regions for the Means of Multivariate Normal Distributions.” <em>Journal of the American Statistical Association</em> 62 (318): 626–33. <a href="https://doi.org/10.1080/01621459.1967.10482935">https://doi.org/10.1080/01621459.1967.10482935</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sabine Schilling.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
