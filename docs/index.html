<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Automated Selection and Visualisation of Statistical Hypothesis Tests • visStatistics</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Automated Selection and Visualisation of Statistical Hypothesis Tests">
<meta name="description" content="Automatically selects and visualises appropriate statistical hypothesis tests between a response and a feature variable in a data frame. The choice of test depends on the class, distribution, and sample size of the input variables, as well as the user-defined conf.level. The package focuses on visualising the selected test using appropriate plots— such as box plots, bar charts, regression lines with confidence bands, mosaic plots, residual plots and Q–Q plots. Each plot is annotated with relevant test statistics and, where applicable, assumption checks and post-hoc results. The scripted workflow is particularly well suited for interactive interfaces where users access data only through a graphical front end backed by server-side R sessions, as well as for quick data exploration, for example, in statistical consulting contexts. Implemented tests: t.test(), wilcox.test(), aov(), oneway.test(), kruskal.test(), lm(), fisher.test(), chisq.test(). Tests for normality: shapiro.test(), ad.test(). Tests for equal variances: bartlett.test(). Post-hoc tests: TukeyHSD(), pairwise.wilcox.test().">
<meta property="og:description" content="Automatically selects and visualises appropriate statistical hypothesis tests between a response and a feature variable in a data frame. The choice of test depends on the class, distribution, and sample size of the input variables, as well as the user-defined conf.level. The package focuses on visualising the selected test using appropriate plots— such as box plots, bar charts, regression lines with confidence bands, mosaic plots, residual plots and Q–Q plots. Each plot is annotated with relevant test statistics and, where applicable, assumption checks and post-hoc results. The scripted workflow is particularly well suited for interactive interfaces where users access data only through a graphical front end backed by server-side R sessions, as well as for quick data exploration, for example, in statistical consulting contexts. Implemented tests: t.test(), wilcox.test(), aov(), oneway.test(), kruskal.test(), lm(), fisher.test(), chisq.test(). Tests for normality: shapiro.test(), ad.test(). Tests for equal variances: bartlett.test(). Post-hoc tests: TukeyHSD(), pairwise.wilcox.test().">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">visStatistics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="articles/visStatistics.html">Vignette</a></li>
<li class="nav-item"><a class="nav-link" href="articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/shhschilling/visStatistics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="visstatistics-the-right-test-visualised">visStatistics: The right test, visualised<a class="anchor" aria-label="anchor" href="#visstatistics-the-right-test-visualised"></a>
</h1></div>
<p>The R package <code>visStatistics</code> allows for rapid visualisation and statistical analysis of raw data. It automatically selects and visualises the most appropriate statistical hypothesis test between a response (<code>varsample</code>) and a feature (<code>varfactor</code>) within a <code>data.frame</code>. The package focuses on visualising the selected test using appropriate plots - such as box plots, bar charts, regression lines with confidence bands, mosaic plots, residual plots and Q–Q plots. Each plot is annotated with relevant test statistics and, where applicable, assumption checks and post-hoc results. The scripted workflow is particularly well suited for interactive interfaces, where users access data only through a graphical front end backed by server-side R sessions, as well as for quick data exploration, for example, in statistical consulting contexts.</p>
</div>
<div class="section level1">
<h1 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h1>
<p>A minimal function call looks of its main function <code><a href="reference/visstat.html">visstat()</a></code> looks like:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">visstat</span>(dataframe, <span class="at">varsample =</span> <span class="st">"response"</span>, <span class="at">varfactor =</span> <span class="st">"feature"</span>)</span></code></pre></div>
<p>The input must be a column - based <code>data.frame</code>, and <code>varsample</code> and <code>varfactor</code> are character strings naming columns of that data frame.</p>
<p>The function selects a statistical test based on the class of the response and feature variables, the number of levels in categorical variables, and conditions such as normality and homoscedasticity.</p>
<p>The automatically generated output figures illustrate the selected statistical test, display the main test statistics, and include assumption checks and post hoc comparisons when applicable. The primary test results are returned as a list object.</p>
</div>
<div class="section level1">
<h1 id="installation-of-latest-stable-version-from-cran">Installation of latest stable version from CRAN<a class="anchor" aria-label="anchor" href="#installation-of-latest-stable-version-from-cran"></a>
</h1>
<ol style="list-style-type: decimal">
<li>Install the package</li>
</ol>
<!-- --><div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"visStatistics"</span>)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Load the package</li>
</ol>
<!-- --><div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">library</span>(visStatistics)</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="installation-of-the-development-version-from-github">Installation of the development version from GitHub<a class="anchor" aria-label="anchor" href="#installation-of-the-development-version-from-github"></a>
</h1>
<ol style="list-style-type: decimal">
<li>Install <strong>devtools</strong> from CRAN if not already installed:</li>
</ol>
<!-- --><div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"devtools"</span>)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Load the <strong>devtools</strong> package:</li>
</ol>
<!-- --><div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">library</span>(devtools)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Install the <code>visStatistics</code> package from GitHub:</li>
</ol>
<!-- --><div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">"shhschilling/visStatistics"</span>)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Load the <code>visStatistics</code> package:</li>
</ol>
<!-- --><div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">library</span>(visStatistics)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>View help for the main function:</li>
</ol>
<!-- --><div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>? visstat</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Study all the details of the package in its vignette:</li>
</ol>
<!-- --><div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">vignette</span>(<span class="st">"visStatistics"</span>)</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="decision-logic">Decision logic<a class="anchor" aria-label="anchor" href="#decision-logic"></a>
</h1>
<p>Throughout the remainder, data of class <code>"numeric"</code> or <code>"integer"</code> are referred as numerical, while data of class <code>"factor"</code> are referred to as categorical. The choice of statistical tests performed by the function <code><a href="reference/visstat.html">visstat()</a></code> depends on whether the data are numerical or categorical, the number of levels in the categorical variable, and the distribution of the data. The function prioritizes interpretable visual output and tests that remain valid under the the following decision logic:</p>
<ol style="list-style-type: decimal">
<li>When the response is numerical and the predictor is categorical, a statistical hypothesis test of central tendencies is selected.</li>
</ol>
<ul>
<li><p>If the categorical predictor has exactly two levels, Welch’s t-test (<code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code>) is applied whenever both groups contain more than 30 observations, with the validity of the test supported by the approximate normality of the sampling distribution of the mean under the central limit theorem Lumley et al. (2002). For smaller samples, group - wise normality is assessed using the Shapiro - Wilk test (<code><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test()</a></code>) at the significance level <em>α</em>. If both groups are found to be approximately normally distributed according to the Shapiro - Wilk test, Welch’s t-test is applied; otherwise, the Wilcoxon rank-sum test (<code><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test()</a></code>) is used.</p></li>
<li><p>For predictors with more than two levels, a model of Fisher’s one-way analysis of variables (ANOVA) (<code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code>) is initially fitted. The normality of residuals is evaluated using both the Shapiro-Wilk test (<code><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test()</a></code>) and the Anderson-Darling test (<code>ad.test()</code>); residuals are considered approximately normal if at least one of the two tests yields a result exceeding the significance threshold <em>α</em>. If this condition is met, Bartlett’s test (<code><a href="https://rdrr.io/r/stats/bartlett.test.html" class="external-link">bartlett.test()</a></code>) is then used to assess homoscedasticity. When variances are homogeneous (<em>p</em> &gt; <em>α</em>), Fisher’s one-way ANOVA (<code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code>) is applied with Tukey’s Honestly Significant Differences (HSD) (<code><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD()</a></code>) for post-hoc comparison. If variances differ significantly (<em>p</em> ≤ <em>α</em>), Welch’s heteroscedastic one-way ANOVA (<code><a href="https://rdrr.io/r/stats/oneway.test.html" class="external-link">oneway.test()</a></code>) is used, also followed by Tukey’s HSD. If residuals are not normally distributed according to both tests (<em>p</em> ≤ <em>α</em>), the Kruskal-Wallis test (<code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test()</a></code>) is selected, followed by pairwise Wilcoxon tests (<code><a href="https://rdrr.io/r/stats/pairwise.wilcox.test.html" class="external-link">pairwise.wilcox.test()</a></code>). A graphical overview of the decision logic used is provided in the figure below.</p></li>
</ul>
<p><img src="reference/figures/decision_tree.png" width="100%" alt="Decision tree used to select the appropriate statistical test."></p>
<p style="font-style: italic; font-size: 90%; margin-top: 0.5em;">
Decision tree used to select the appropriate statistical test for a categorical predictor and numerical response, based on the number of factor levels, normality, and homoscedasticity.
</p>
<ol style="list-style-type: decimal">
<li>When both the response and predictor are numerical, a simple linear regression model (<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>) is fitted and analysed in detail, including residual diagnostics, formal tests, and the plotting of fitted values with confidence bands. Note that only one explanatory variable is allowed, as the function is designed for two-dimensional visualisation.</li>
</ol>
<!-- (3) Categorical response and categorical predictor --><ol style="list-style-type: decimal">
<li>In the case of two categorical variables, <code><a href="reference/visstat.html">visstat()</a></code> tests the null hypothesis that the predictor and response variables are independent using either Pearson’s <em>χ</em><sup>2</sup>-test (<code><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test()</a></code>) or Fisher’s exact test (<code><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test()</a></code>). The choice of test is based on Cochran’s rule (Cochran 1954), which advises that the <em>χ</em><sup>2</sup>approximation is reliable only if no expected cell count is less than 1 and no more than 20 percent of cells have expected counts below 5.</li>
</ol>
<p>Note: Except for the user - adjustable <code>conf.level</code> parameter, all statistical tests are applied using their default settings from the corresponding base R functions (e.g., <code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code>). As a consequence, paired tests are not currently supported. Furthermore, since the main purpose of this package is to visualize statistical test results, only simple linear regression is implemented. For a more detailed description of the underlying decision logic see</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">vignette</span>(<span class="st">"visStatistics"</span>)</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h1>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">library</span>(visStatistics)</span></code></pre></div>
<p>In this section, function names in parentheses in the headings indicate the statistical test selected by the decision logic of <code><a href="reference/visstat.html">visstat()</a></code>.</p>
<div class="section level2">
<h2 id="numerical-response-and-categorical-feature">Numerical response and categorical feature<a class="anchor" aria-label="anchor" href="#numerical-response-and-categorical-feature"></a>
</h2>
<p>When the response is numerical and the feature is categorical, test of central tendencies are selected.</p>
<div class="section level3">
<h3 id="welchs-t-test-ttest">Welch’s t-test (<code>t.test()</code>)<a class="anchor" aria-label="anchor" href="#welchs-t-test-ttest"></a>
</h3>
<div class="section level4">
<h4 id="insectsprays-dataset">InsectSprays dataset<a class="anchor" aria-label="anchor" href="#insectsprays-dataset"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>insect_sprays_a_b <span class="ot">&lt;-</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>InsectSprays[<span class="fu">which</span>(InsectSprays<span class="sc">$</span>spray <span class="sc">==</span> <span class="st">"A"</span> <span class="sc">|</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>InsectSprays<span class="sc">$</span>spray <span class="sc">==</span> <span class="st">"B"</span>), ]</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>insect_sprays_a_b<span class="sc">$</span>spray <span class="ot">&lt;-</span> <span class="fu">factor</span>(insect_sprays_a_b<span class="sc">$</span>spray)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="fu">visstat</span>(insect_sprays_a_b, <span class="st">"count"</span>, <span class="st">"spray"</span>)</span></code></pre></div>
<p><img src="reference/figures/README-insect-sprays-data-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="mtcars-dataset">mtcars dataset<a class="anchor" aria-label="anchor" href="#mtcars-dataset"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>mtcars<span class="sc">$</span>am <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mtcars<span class="sc">$</span>am)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>t_test_statistics <span class="ot">&lt;-</span> <span class="fu">visstat</span>(mtcars, <span class="st">"mpg"</span>, <span class="st">"am"</span>)</span></code></pre></div>
<p><img src="reference/figures/README-mtcars-data-1.png" width="100%"></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co">#t_test_statistics</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="wilcoxon-rank-sum-test-wilcoxtest">Wilcoxon rank-sum test (<code>wilcox.test()</code>)<a class="anchor" aria-label="anchor" href="#wilcoxon-rank-sum-test-wilcoxtest"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>grades_gender <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="at">sex =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"girl"</span>, <span class="st">"boy"</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">23</span>))),</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="at">grade =</span> <span class="fu">c</span>(</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>    <span class="fl">19.3</span>, <span class="fl">18.1</span>, <span class="fl">15.2</span>, <span class="fl">18.3</span>, <span class="fl">7.9</span>, <span class="fl">6.2</span>, <span class="fl">19.4</span>, <span class="fl">20.3</span>, <span class="fl">9.3</span>, <span class="fl">11.3</span>,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>    <span class="fl">18.2</span>, <span class="fl">17.5</span>, <span class="fl">10.2</span>, <span class="fl">20.1</span>, <span class="fl">13.3</span>, <span class="fl">17.2</span>, <span class="fl">15.1</span>, <span class="fl">16.2</span>, <span class="fl">17.0</span>, <span class="fl">16.5</span>, <span class="fl">5.1</span>,</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>    <span class="fl">15.3</span>, <span class="fl">17.1</span>, <span class="fl">14.8</span>, <span class="fl">15.4</span>, <span class="fl">14.4</span>, <span class="fl">7.5</span>, <span class="fl">15.5</span>, <span class="fl">6.0</span>, <span class="fl">17.4</span>, <span class="fl">7.3</span>, <span class="fl">14.3</span>,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>    <span class="fl">13.5</span>, <span class="fl">8.0</span>, <span class="fl">19.5</span>, <span class="fl">13.4</span>, <span class="fl">17.9</span>, <span class="fl">17.7</span>, <span class="fl">16.4</span>, <span class="fl">15.6</span>, <span class="fl">17.3</span>, <span class="fl">19.9</span>, <span class="fl">4.4</span>, <span class="fl">2.1</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>  )</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>)</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>wilcoxon_statistics <span class="ot">&lt;-</span> <span class="fu">visstat</span>(grades_gender, <span class="st">"grade"</span>, <span class="st">"sex"</span>)</span></code></pre></div>
<p><img src="reference/figures/README-sex-grades2-data-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="fishers-one-way-anova-aov">Fisher’s one-way ANOVA (<code>aov()</code>)<a class="anchor" aria-label="anchor" href="#fishers-one-way-anova-aov"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>insect_sprays_tr <span class="ot">&lt;-</span> InsectSprays</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>insect_sprays_tr<span class="sc">$</span>count_sqrt <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(InsectSprays<span class="sc">$</span>count)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="fu">visstat</span>(insect_sprays_tr, <span class="st">"count_sqrt"</span>, <span class="st">"spray"</span>)</span></code></pre></div>
<p><img src="reference/figures/README-insectprays-anova-data-1.png" width="100%"><img src="reference/figures/README-insectprays-anova-data-2.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="welchs-heteroscedastic-one-way-anova-onewaytest">Welch’s heteroscedastic one-way ANOVA (<code>oneway.test()</code>)<a class="anchor" aria-label="anchor" href="#welchs-heteroscedastic-one-way-anova-onewaytest"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>one_way_npk <span class="ot">&lt;-</span> <span class="fu">visstat</span>(npk, <span class="st">"yield"</span>, <span class="st">"block"</span>)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-1.png" width="100%"><img src="reference/figures/README-unnamed-chunk-2-2.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="kruskalwallis-test-kruskaltest">Kruskal–Wallis test (<code>kruskal.test()</code>)<a class="anchor" aria-label="anchor" href="#kruskalwallis-test-kruskaltest"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">visstat</span>(iris, <span class="st">"Petal.Width"</span>, <span class="st">"Species"</span>)</span></code></pre></div>
<p><img src="reference/figures/README-iris-kruskal-1.png" width="100%"><img src="reference/figures/README-iris-kruskal-2.png" width="100%"> The generated graphs can be saved in all available formats of the <code>Cairo</code> package. Here we save the graphical output of type “pdf” in the <code>plotDirectory</code> <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">visstat</span>(</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>iris,</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="st">"Petal.Width"</span>,</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="st">"Species"</span>,</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="at">graphicsoutput =</span> <span class="st">"pdf"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="at">plotDirectory =</span> <span class="fu">tempdir</span>()</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="numerical-response-and-numerical-feature">Numerical response and numerical feature:<a class="anchor" aria-label="anchor" href="#numerical-response-and-numerical-feature"></a>
</h2>
<div class="section level3">
<h3 id="simple-linear-regression-lm">Simple linear Regression (<code>lm()</code>)<a class="anchor" aria-label="anchor" href="#simple-linear-regression-lm"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>linreg_cars <span class="ot">&lt;-</span> <span class="fu">visstat</span>(cars, <span class="st">"dist"</span>, <span class="st">"speed"</span>)</span></code></pre></div>
<p><img src="reference/figures/README-lin-reg-dist-speed-1.png" width="100%"><img src="reference/figures/README-lin-reg-dist-speed-2.png" width="100%"></p>
<p>Increasing the confidence level <code>conf.level</code> from the default 0.95 to 0.99 leads two wider confidence and prediction bands:</p>
<p><img src="reference/figures/README-pressure-1.png" width="100%"><img src="reference/figures/README-pressure-2.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="categorical-response-and-categorical-feature">Categorical response and categorical feature<a class="anchor" aria-label="anchor" href="#categorical-response-and-categorical-feature"></a>
</h2>
<div class="section level3">
<h3 id="pearsons-χ2-test-chisqtest">Pearson’s <em>χ</em><sup>2</sup>-test (<code>chisq.test()</code>)<a class="anchor" aria-label="anchor" href="#pearsons-%CF%872-test-chisqtest"></a>
</h3>
<p>Count datasets are often presented as multidimensional arrays, so - called contingency tables, whereas <code><a href="reference/visstat.html">visstat()</a></code> requires a <code>data.frame</code> with a column structure. Arrays can be transformed to this column wise structure with the helper function <code><a href="reference/counts_to_cases.html">counts_to_cases()</a></code>:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>hair_eye_color_df <span class="ot">&lt;-</span> <span class="fu">counts_to_cases</span>(<span class="fu">as.data.frame</span>(HairEyeColor))</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="fu">visstat</span>(hair_eye_color_df, <span class="st">"Hair"</span>, <span class="st">"Eye"</span>)</span></code></pre></div>
<p><img src="reference/figures/README-chihair-data-1.png" width="100%"><img src="reference/figures/README-chihair-data-2.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="fishers-exact-test-fishertest">Fisher’s exact test (<code>fisher.test()</code>)<a class="anchor" aria-label="anchor" href="#fishers-exact-test-fishertest"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>hair_eye_color_male <span class="ot">&lt;-</span> HairEyeColor[, , <span class="dv">1</span>]</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="co"># Slice out a 2 by 2 contingency table</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>black_brown_hazel_green_male <span class="ot">&lt;-</span> hair_eye_color_male[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co"># Transform to data frame</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>black_brown_hazel_green_male <span class="ot">&lt;-</span> <span class="fu">counts_to_cases</span>(<span class="fu">as.data.frame</span>(black_brown_hazel_green_male))</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="co"># Fisher test</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>fisher_stats <span class="ot">&lt;-</span> <span class="fu">visstat</span>(black_brown_hazel_green_male, <span class="st">"Hair"</span>, <span class="st">"Eye"</span>)</span></code></pre></div>
<p><img src="reference/figures/README-haireye-fisher-1.png" width="100%"><img src="reference/figures/README-haireye-fisher-2.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="implemented-tests">Implemented tests<a class="anchor" aria-label="anchor" href="#implemented-tests"></a>
</h2>
<p>Note that all test are implemented with their default settings, with the exception of the user-adjustable <code>conf.level</code>.</p>
<div class="section level3">
<h3 id="numerical-response-and-categorical-feature-1">Numerical response and categorical feature<a class="anchor" aria-label="anchor" href="#numerical-response-and-categorical-feature-1"></a>
</h3>
<div class="section level4">
<h4 id="main-tests">Main tests<a class="anchor" aria-label="anchor" href="#main-tests"></a>
</h4>
<p><code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code>, <code><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test()</a></code>, <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code>, <code><a href="https://rdrr.io/r/stats/oneway.test.html" class="external-link">oneway.test()</a></code>, <code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test()</a></code></p>
</div>
<div class="section level4">
<h4 id="normality-assumption-check">Normality assumption check<a class="anchor" aria-label="anchor" href="#normality-assumption-check"></a>
</h4>
<p><code><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test()</a></code> and <code>ad.test()</code></p>
</div>
<div class="section level4">
<h4 id="homoscedasticity-assumption-check">Homoscedasticity assumption check<a class="anchor" aria-label="anchor" href="#homoscedasticity-assumption-check"></a>
</h4>
<p><code><a href="https://rdrr.io/r/stats/bartlett.test.html" class="external-link">bartlett.test()</a></code></p>
</div>
<div class="section level4">
<h4 id="post-hoc-tests">Post-hoc tests<a class="anchor" aria-label="anchor" href="#post-hoc-tests"></a>
</h4>
<ul>
<li>
<code><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD()</a></code> (used following <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code>and <code><a href="https://rdrr.io/r/stats/oneway.test.html" class="external-link">oneway.test()</a></code>)</li>
<li>
<code><a href="https://rdrr.io/r/stats/pairwise.wilcox.test.html" class="external-link">pairwise.wilcox.test()</a></code> (used following <code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test()</a></code>)</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="numerical-response-and-numerical-feature-1">Numerical response and numerical feature:<a class="anchor" aria-label="anchor" href="#numerical-response-and-numerical-feature-1"></a>
</h3>
<p>Simple linear regression: <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code></p>
<p>Note that multiple linear regression models are not implemented, as the package focuses on the visualisation of data, not model building.</p>
</div>
<div class="section level3">
<h3 id="categorical-response-and-categorical-feature-1">Categorical response and categorical feature<a class="anchor" aria-label="anchor" href="#categorical-response-and-categorical-feature-1"></a>
</h3>
<ul>
<li>
<code><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test()</a></code> (default for larger samples)</li>
<li>
<code><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test()</a></code> (used for small expected cell counts based on Cochran’s rule (Cochran 1954))</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<!-- pkgdown::end -->
<p>Cochran, William G. 1954. “The Combination of Estimates from Different Experiments.” <em>Biometrics</em> 10 (1): 101. <a href="https://doi.org/10.2307/3001666" class="external-link uri">https://doi.org/10.2307/3001666</a>.</p>
<p>Lumley, Thomas, Paula Diehr, Scott Emerson, and Lu Chen. 2002. “The Importance of the Normality Assumption in Large Public Health Data Sets.” <em>Annual Review of Public Health</em> 23: 151–69. <a href="https://doi.org/10.1146/annurev.publhealth.23.100901.140546" class="external-link uri">https://doi.org/10.1146/annurev.publhealth.23.100901.140546</a>.</p>
<p>Rasch, Dieter, Klaus D. Kubinger, and Karl Moder. 2011. “The Two-Sample t Test: Pre-Testing Its Assumptions Does Not Pay Off.” <em>Statistical Papers</em> 52 (1): 219–31. <a href="https://doi.org/10.1007/s00362-009-0224-x" class="external-link uri">https://doi.org/10.1007/s00362-009-0224-x</a>.</p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=visStatistics" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/shhschilling/visStatistics/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/shhschilling/visStatistics/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing visStatistics</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Sabine Schilling <br><small class="roles"> Maintainer, author, copyright holder </small> <a href="https://orcid.org/0000-0002-8318-9421" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sabine Schilling.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
