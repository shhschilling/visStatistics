<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>visStatistics • visStatistics</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="visStatistics">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">visStatistics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/shhschilling/visStatistics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>visStatistics</h1>
                        <h4 data-toc-skip class="author">Sabine
Schilling</h4>
            
            <h4 data-toc-skip class="date">2025-05-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/shhschilling/visStatistics/blob/HEAD/vignettes/visStatistics.Rmd" class="external-link"><code>vignettes/visStatistics.Rmd</code></a></small>
      <div class="d-none name"><code>visStatistics.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/shhschilling/visStatistics/" class="external-link">visStatistics</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 class="unnumbered" id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h2>
<p>The package <code>visStatistics</code> enables rapid visualization
and statistical analysis of raw data by automatically selecting the
hypothesis test with the highest statistical power to evaluate the
relationship between a response (<code>varsample</code>) and a feature
(<code>varfactor</code>) within a <code>data.frame</code>. Its core
function, <code><a href="../reference/visstat.html">visstat()</a></code>, generates a graph showing key
statistics from the selected test and returns the corresponding test
results, including any post-hoc analysis.</p>
<p>A minimal function call has the form
<code>visstat(dataframe, varsample, varfactor)</code>.</p>
<p>The input <code>data.frame</code> must be column-based, and the
arguments <code>varsample</code> and <code>varfactor</code> must be
character strings naming columns of the <code>data.frame</code>. The
significance level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
used throughout for hypothesis testing, is defined as
<code>1 - conf.level</code>, where <code>conf.level</code> is a
user-controllable argument (defaulting to <code>0.95</code>). Data of
class <code>"numeric"</code> or <code>"integer"</code> are referred to
in the remainder of this vignette as numerical, while data of class
<code>"factor"</code> are referred to as categorical.</p>
<p>The choice of statistical tests performed by the function
<code><a href="../reference/visstat.html">visstat()</a></code> depends on whether the data are numerical or
categorical, the number of levels in the categorical variable, and the
distribution of the data. The function prioritizes interpretable visual
output and tests that remain valid under the assumptions evaluated
applying the following decision logic:</p>
<ol style="list-style-type: decimal">
<li><p>When the response is numerical and the predictor is categorical,
test of central tendencies are performed. If the categorical predictor
has two levels, Welch’s t-test (<code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code>) is used, if both
groups have more than 30 observations, relying on the central limit
theorem to justify its application regardless of underlying normality
<span class="citation">(Lumley et al. 2002)</span>. For smaller samples,
group-wise normality is assessed using the Shapiro-Wilk test
(<code><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test()</a></code>). If both groups return p-values greater
than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
Welch’s t-test is applied; otherwise, the Wilcoxon rank-sum test
(<code><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test()</a></code>) is used. For predictors with more than two
levels, an ANOVA model (<code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code>) is initially fitted.
Residual normality is evaluated using both the Shapiro-Wilk test
(<code><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test()</a></code>) and Anderson-Darling test
(<code>ad.test()</code>), and normality is assumed if either test yields
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&gt;</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">p &gt; \alpha</annotation></semantics></math>.
If the residuals are considered normal, Bartlett’s test
(<code><a href="https://rdrr.io/r/stats/bartlett.test.html" class="external-link">bartlett.test()</a></code>) is used to assess homoscedasticity. When
variances are homogeneous
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&gt;</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">p &gt; \alpha</annotation></semantics></math>),
ANOVA is applied with Tukey’s HSD (<code><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD()</a></code>) for post-hoc
comparison. If variances differ significantly
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>≤</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">p \le \alpha</annotation></semantics></math>),
Welch’s one-way test (<code><a href="https://rdrr.io/r/stats/oneway.test.html" class="external-link">oneway.test()</a></code>) is used, also followed
by Tukey’s HSD. If residuals are not normally distributed according to
both tests
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>≤</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">p \le \alpha</annotation></semantics></math>),
the Kruskal-Wallis test (<code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test()</a></code>) is selected,
followed by pairwise Wilcoxon tests
(<code><a href="https://rdrr.io/r/stats/pairwise.wilcox.test.html" class="external-link">pairwise.wilcox.test()</a></code>).</p></li>
<li><p>When both the response and predictor are numerical, a simple
linear regression model (<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>) is fitted and analysed in
detail, including residual diagnostics, formal tests, and the plotting
of fitted values with confidence bands. Note that only one explanatory
variable is allowed, as the function is designed for two-dimensional
visualisation.</p></li>
<li><p>In the case of two categorical variables, <code><a href="../reference/visstat.html">visstat()</a></code>
tests the null hypothesis that the predictor and response variables are
independent using either <code><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test()</a></code> or
<code><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test()</a></code>. The choice of test is based on Cochran’s
rule <span class="citation">(Cochran 1954)</span>, which advises that
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
approximation is reliable only if no expected cell count is zero and no
more than 20 percent of cells have expected counts below 5.</p></li>
</ol>
<p>Note: Except for the user-adjustable <code>conf.level</code>
parameter, all statistical tests are applied using their default
settings from the corresponding base R functions (e.g.,
<code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code>). As a consequence, paired tests are not currently
supported. Furthermore, since the main purpose of this package is to
visualize statistical test results, only simple linear regression is
implemented.</p>
</div>
<div class="section level2">
<h2 id="sec-decisiontree">Decision logic for selecting tests of central tendency<a class="anchor" aria-label="anchor" href="#sec-decisiontree"></a>
</h2>
<p>If the feature consists of <code>class</code> “<code>factor</code>”
with two or more levels and the response consists is of
<code>class</code> “<code>numeric</code>” or “<code>integer</code>”
(both having mode “<code>numeric</code>”), statistical tests are applied
to compare the central tendencies across groups. This section describes
the conditions under which parametric and non-parametric tests are
chosen, based on the response type, the number of factor levels, and the
underlying distributional assumptions. A graphical overview of the
decision logic used is provided in Figure
@ref(fig:fig-decision-tree).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html" class="external-link">include_graphics</a></span><span class="op">(</span><span class="st">"../man/figures/decision_tree.png"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="../reference/figures/decision_tree.png" alt="Decision tree used to select the appropriate statistical test for a categorical predictor and numerical response, based on the number of factor levels, normality and homoscedasticity." width="100%,fig.height =100% "><p class="caption">
Decision tree used to select the appropriate statistical test for a
categorical predictor and numerical response, based on the number of
factor levels, normality and homoscedasticity.
</p>
</div>
<div class="section level3">
<h3 id="two-sample-tests-welchs-t-test-or-wilcoxon-rank-sum-test">Two sample tests: Welch’s <em>t</em>-test or Wilcoxon rank sum
test<a class="anchor" aria-label="anchor" href="#two-sample-tests-welchs-t-test-or-wilcoxon-rank-sum-test"></a>
</h3>
<p>When the feature variable has exactly two levels, Welch’s t-test is
used to compare group means if the assumption of normality is satisfied.
Otherwise, the Wilcoxon rank sum test is applied (see Figure
@ref(fig:fig-decision-tree)).</p>
<p>Welch’s t-test evaluates the null hypothesis that the two groups have
equal means. Unlike Student’s t-test, which assumes equal variances
(homoscedasticity), Welch’s test does not require this assumption.
Welch’s test exhibits minimal loss of robustness even when Student’s
t-test assumptions are satisfied <span class="citation">(Moser and
Stevens 1992; Delacre et al. 2017)</span>. Therefore, Student’s t-test
is not implemented.</p>
<p>The Wilcoxon rank sum test, in contrast, is a non-parametric method
that compares two distributions without requiring normality.</p>
<p>The function selects between these tests as follows. If both groups
have more than 30 observations, Welch’s t-test (<code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code>)
is always performed. For large samples, the test remains robust even
when normality is not strictly met <span class="citation">(Rasch,
Kubinger, and Moder 2011; Lumley et al. 2002)</span>.</p>
<p>If either group has fewer than 30 observations, the function applies
the Shapiro-Wilk test (<code><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test()</a></code>) to each group. If
both
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-values
exceed the significance level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn><mo>−</mo></mrow><annotation encoding="application/x-tex">\alpha = 1 -</annotation></semantics></math><code>conf.level</code>, Welch’s t-test is applied. If at least one
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
falls below
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
the Wilcoxon rank sum test (<code><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test()</a></code>) is used
instead.</p>
<p>The graphical output consists of box plots overlaid with jittered
points to display individual observations. When Welch’s t-test is
applied, the function includes confidence intervals based on the
user-specified <code>conf.level</code>. The function returns a list
containing the results of the applied test and the summary statistics
used to construct the plot.</p>
<div class="section level4">
<h4 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h4>
<div class="section level5">
<h5 class="unnumbered" id="welchs-t-test">Welch’s t-test<a class="anchor" aria-label="anchor" href="#welchs-t-test"></a>
</h5>
<p>As an example, we use the <em>Motor Trend Car Road Tests</em> data
set (<code>mtcars</code>), which contains 32 observations. In the
example below, <code>mpg</code> denotes miles per (US) gallon, and
<code>am</code> represents the transmission type (<code>0</code> =
automatic, <code>1</code> = manual).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span><span class="op">)</span></span>
<span><span class="va">t_test_statistics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="st">"mpg"</span>, <span class="st">"am"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-2-1.png" width="100%"></p>
<p>Increasing the confidence level <code>conf.level</code> from the
default 0.95 to 0.99 results in wider confidence intervals, as a higher
confidence level requires more conservative bounds to ensure that the
interval includes the true parameter value with greater certainty.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span><span class="op">)</span></span>
<span><span class="va">t_test_statistics_99</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="st">"mpg"</span>, <span class="st">"am"</span>, conf.level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-3-1.png" width="100%"></p>
</div>
<div class="section level5">
<h5 class="unnumbered" id="wilcoxon-rank-sum-test">Wilcoxon rank sum test<a class="anchor" aria-label="anchor" href="#wilcoxon-rank-sum-test"></a>
</h5>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grades_gender</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"girl"</span>, <span class="fl">21</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"boy"</span>, <span class="fl">23</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>grade <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span><span class="fl">19.3</span>, <span class="fl">18.1</span>, <span class="fl">15.2</span>, <span class="fl">18.3</span>, <span class="fl">7.9</span>, <span class="fl">6.2</span>, <span class="fl">19.4</span>,</span>
<span><span class="fl">20.3</span>, <span class="fl">9.3</span>, <span class="fl">11.3</span>, <span class="fl">18.2</span>, <span class="fl">17.5</span>, <span class="fl">10.2</span>, <span class="fl">20.1</span>, <span class="fl">13.3</span>, <span class="fl">17.2</span>, <span class="fl">15.1</span>, <span class="fl">16.2</span>, <span class="fl">17.0</span>,</span>
<span><span class="fl">16.5</span>, <span class="fl">5.1</span>, <span class="fl">15.3</span>, <span class="fl">17.1</span>, <span class="fl">14.8</span>, <span class="fl">15.4</span>, <span class="fl">14.4</span>, <span class="fl">7.5</span>, <span class="fl">15.5</span>, <span class="fl">6.0</span>, <span class="fl">17.4</span>,</span>
<span><span class="fl">7.3</span>, <span class="fl">14.3</span>, <span class="fl">13.5</span>, <span class="fl">8.0</span>, <span class="fl">19.5</span>, <span class="fl">13.4</span>, <span class="fl">17.9</span>, <span class="fl">17.7</span>, <span class="fl">16.4</span>, <span class="fl">15.6</span>, <span class="fl">17.3</span>, <span class="fl">19.9</span>, <span class="fl">4.4</span>, <span class="fl">2.1</span></span>
<span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">wilcoxon_statistics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">grades_gender</span>, <span class="st">"grade"</span>, <span class="st">"sex"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="one-way-test-anova-or-kruskal-wallis-test">One-way test, ANOVA or Kruskal-Wallis test<a class="anchor" aria-label="anchor" href="#one-way-test-anova-or-kruskal-wallis-test"></a>
</h3>
<p>If the feature is of <code>class</code> “<code>factor</code>” with
more than two levels and the response is of <code>mode</code>
“<code>numeric</code>”, <code><a href="../reference/visstat.html">visstat()</a></code> initially attempts an
analysis of variance (ANOVA). ANOVA is performed only if both of the
following null hypotheses cannot be rejected at the specified
<code>conf.level</code>:</p>
<ol style="list-style-type: decimal">
<li>The standardized residuals follow a normal distribution, and<br>
</li>
<li>The residuals exhibit homoscedasticity (equal variances across
groups).</li>
</ol>
<p>If only the assumption of normality is satisfied,
<code><a href="../reference/visstat.html">visstat()</a></code> applies Welch’s one-way test
(<code><a href="https://rdrr.io/r/stats/oneway.test.html" class="external-link">oneway.test()</a></code>). If the normality assumption is violated, a
Kruskal-W allis test (<code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test()</a></code>) is used instead.</p>
<p>These assumptions are tested internally using the
<code>visAnovaAssumptions()</code> function.</p>
<div class="section level4">
<h4 id="checking-the-anova-assumptions">Checking the ANOVA assumptions<a class="anchor" aria-label="anchor" href="#checking-the-anova-assumptions"></a>
</h4>
<div class="section level5">
<h5 class="unnumbered" id="residual-analysis-aov_residuals">Residual analysis {#aov_residuals}<a class="anchor" aria-label="anchor" href="#residual-analysis-aov_residuals"></a>
</h5>
<p>The <code>visAnovaAssumptions()</code> function assesses the
normality of standardized residuals from the ANOVA fit using both the
Shapiro-W ilk test (<code><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test()</a></code>) and the Anderson-D
arling test (<code>ad.test()</code>). Normality is assumed if at least
one of the two tests yields a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
greater than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo></mrow><annotation encoding="application/x-tex">1 -</annotation></semantics></math><code>conf.level</code> (see Figure @ref(fig:fig-decision-tree)).</p>
<p>The function generates two diagnostic plots:<br>
- a scatterplot of the standardized residuals against the fitted means
of the linear model for each level of the feature
(<code>varfactor</code>), and<br>
- a Q-Q plot of the standardized residuals.</p>
</div>
<div class="section level5">
<h5 class="unnumbered" id="homoscedasticity-homogeneity-of-variances-in-each-level-bartlett-test">Homoscedasticity: homogeneity of variances in
each level: Bartlett test<a class="anchor" aria-label="anchor" href="#homoscedasticity-homogeneity-of-variances-in-each-level-bartlett-test"></a>
</h5>
<p>Both <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> and <code><a href="https://rdrr.io/r/stats/oneway.test.html" class="external-link">oneway.test()</a></code> assess whether
two or more samples drawn from normal distributions have the same mean.
While <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> assumes homogeneity of variances across groups,
<code><a href="https://rdrr.io/r/stats/oneway.test.html" class="external-link">oneway.test()</a></code> does not require the variances to be
equal.</p>
<p>Homoscedasticity is assessed using
Bartlett<code>s test (</code>bartlett.test()`), which tests the null
hypothesis that the variances across all levels of the grouping variable
are equal.</p>
</div>
</div>
<div class="section level4">
<h4 id="one-way-test-and-anova">One-way test and ANOVA<a class="anchor" aria-label="anchor" href="#one-way-test-and-anova"></a>
</h4>
<p>Depending on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
returned by <code><a href="https://rdrr.io/r/stats/bartlett.test.html" class="external-link">bartlett.test()</a></code>, the corresponding test is
selected and its
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
is displayed in the figure title:</p>
<ul>
<li>If the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
of <code><a href="https://rdrr.io/r/stats/bartlett.test.html" class="external-link">bartlett.test()</a></code> is greater than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo></mrow><annotation encoding="application/x-tex">1 -</annotation></semantics></math><code>conf.level</code>, we assume homogeneity of variances across
groups and report the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
from the ANOVA (<code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code>).</li>
<li>Otherwise, homoscedasticity cannot be assumed, and the function
reports the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
from’Welch’s one-way test (<code><a href="https://rdrr.io/r/stats/oneway.test.html" class="external-link">oneway.test()</a></code>).</li>
</ul>
<div class="section level5">
<h5 class="unnumbered" id="post-hoc-analysis-tukeys-honestly-significant-differences-hsd-and-sidak-corrected-confidence-intervals">Post-hoc analysis: Tukey’s Honestly Significant
Differences (HSD) and Sidak-corrected confidence intervals<a class="anchor" aria-label="anchor" href="#post-hoc-analysis-tukeys-honestly-significant-differences-hsd-and-sidak-corrected-confidence-intervals"></a>
</h5>
<p>Simple pairwise comparisons of group means following an analysis of
variance increase the probability of incorrectly declaring a significant
difference when, in fact, there is none .</p>
<p>This inflation of error is quantified by the family-wise error rate,
which refers to the probability of making at least one Type I error,
that is, falsely rejecting the null hypothesis across all pairwise
comparisons.</p>
<p>To control it, <code><a href="../reference/visstat.html">visstat()</a></code> performs post-hoc analysis
using Tukey’s Honestly Significant Difference (HSD) test and displays
Sidak-corrected confidence intervals.</p>
<p>The <code><a href="../reference/visstat.html">visstat()</a></code> function controls the probability of a
Type I error by applying Tukey`s Honestly Significant Differences
procedure, as implemented in <code><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD()</a></code>.<br>
Based on the specified confidence level (<code>conf.level</code>), it
constructs a set of confidence intervals for all pairwise differences
between factor level means. A significant difference between two means
is indicated when the corresponding confidence interval does not include
zero.<br>
The function returns both the HSD-adjusted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-values
and the associated confidence intervals for all pairwise
comparisons.</p>
<p>In the graphical output for the one-way test and ANOVA, green letters
displayed below each group summarize the results of the Tukey HSD
post-hoc test: Two groups are considered significantly different if they
are assigned different letters, indicating a Tukey HSD-adjusted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
smaller than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn><mo>−</mo></mrow><annotation encoding="application/x-tex">\alpha = 1 -</annotation></semantics></math><code>conf.level</code>.</p>
<p>Tukey`s HSD procedure is based on pairwise comparisons of the
differences between the means at each factor level and produces a set of
corresponding confidence intervals. The Sidak procedure, on the other
hand, addresses the problems of a type I error by lowering the
acceptable probability of a type I error for all comparisons of the
levels of the independent, categorical variable.</p>
<p>The Sidak corrected acceptable probability of error <span class="citation">(Šidák 1967)</span> is defined as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mrow><mi>S</mi><mi>i</mi><mi>d</mi><mi>a</mi><mi>k</mi></mrow></msub><mo>=</mo><mo stretchy="false" form="prefix">(</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\alpha_{Sidak}=(1</annotation></semantics></math>-<code>conf.int</code><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mo stretchy="false" form="postfix">)</mo><mrow><mn>1</mn><mi>/</mi><mi>M</mi></mrow></msup><annotation encoding="application/x-tex">)^{1/M}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mfrac><mrow><mi>n</mi><mo>⋅</mo><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">M=\frac{n\cdot (n-1)}{2}</annotation></semantics></math>
is the number of pairwise comparisons of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
levels of the categorical variable.</p>
<p>In the graphical display of One-way test and ANOVA,
<code><a href="../reference/visstat.html">visstat()</a></code> displays both the <code>conf.level</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>⋅</mi><mspace width="0.278em"></mspace><mn>100</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">\cdot\; 100 \%</annotation></semantics></math>-confidence
intervals alongside the larger, Sidak-corrected
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>α</mi><mrow><mi>S</mi><mi>i</mi><mi>d</mi><mi>a</mi><mi>k</mi></mrow></msub><mo stretchy="false" form="postfix">)</mo><mo>⋅</mo><mn>100</mn><mspace width="0.278em"></mspace><mi>%</mi></mrow><annotation encoding="application/x-tex">(1-\alpha_{Sidak})\cdot 100\;\%</annotation></semantics></math>-confidence
intervals.</p>
<p>Note that the current structure of <code><a href="../reference/visstat.html">visstat()</a></code> does not
allow the study of interactions between the different levels of an
independent variable.</p>
</div>
</div>
<div class="section level4">
<h4 id="kruskal-wallis-test">Kruskal-Wallis test<a class="anchor" aria-label="anchor" href="#kruskal-wallis-test"></a>
</h4>
<p>If the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
from the Shapiro-Wilk test (<code><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test()</a></code>) applied to the
standardized residuals is smaller than the significance level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo></mrow><annotation encoding="application/x-tex">1 -</annotation></semantics></math><code>conf.level</code>, <code><a href="../reference/visstat.html">visstat()</a></code> selects a non-parametric
alternative: the Kruskal-Wallis rank sum test.</p>
<p>The function <code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test()</a></code> tests the null hypothesis
that the group medians are equal across all levels of the categorical
feature.</p>
<div class="section level5">
<h5 class="unnumbered" id="post-hoc-analysis-pairwise-wilcox-test">Post-hoc analysis:
<code>pairwise.wilcox.test()</code><a class="anchor" aria-label="anchor" href="#post-hoc-analysis-pairwise-wilcox-test"></a>
</h5>
<p>As post-hoc analysis following the Kruskal-Wallis test,
<code><a href="../reference/visstat.html">visstat()</a></code> applies the pairwise Wilcoxon rank sum test using
<code><a href="https://rdrr.io/r/stats/pairwise.wilcox.test.html" class="external-link">pairwise.wilcox.test()</a></code>, with Holm-s method as the default
adjustment for multiple comparisons <span class="citation">(Holm
1979)</span>.</p>
<p>If the Holm-adjusted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
for a given pair of groups is smaller than the significance level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo></mrow><annotation encoding="application/x-tex">1 -</annotation></semantics></math><code>conf.level</code>, the green letters displayed below the
corresponding box plots will differ. Otherwise, the groups are
considered not significantly different.</p>
<p>Apart from the multiple comparison adjustment, the graphical
representation of the Kruskal-Wallis result is similar to that used for
the Wilcoxon rank sum test.</p>
<p>The function returns a list containing the test statistic from the
Kruskal-Wallis rank sum test, along with the Holm-adjusted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-values
for all pairwise comparisons.</p>
</div>
</div>
<div class="section level4">
<h4 id="examples-1">Examples<a class="anchor" aria-label="anchor" href="#examples-1"></a>
</h4>
<div class="section level5">
<h5 class="unnumbered" id="one-way-test">One-way test:<a class="anchor" aria-label="anchor" href="#one-way-test"></a>
</h5>
<p>The <code>npk</code> dataset reports the yield of peas (in pounds per
block) from an agricultural experiment conducted on six blocks. In this
experiment, the application of three different fertilisers - nitrogen
(N), phosphate (P), and potassium (K) - was varied systematically. Each
block received either none, one, two, or all three of the
fertilisers,</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oneway_npk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">npk</span>, <span class="st">"yield"</span>, <span class="st">"block"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-5-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-5-2.png" width="100%"></p>
<p>Normality of residuals is supported by graphical diagnostics (scatter
plot of standardized residuals, Q-Q plot) and formal tests (Shapiro-Wilk
and Anderson-Darling, both with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&gt;</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">p &gt; \alpha</annotation></semantics></math>).
However, homogeneity of variances is not supported at the given
confidence level
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&lt;</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">p &lt; \alpha</annotation></semantics></math>,
<code><a href="https://rdrr.io/r/stats/bartlett.test.html" class="external-link">bartlett.test()</a></code>), so the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
from the variance-robust <code><a href="https://rdrr.io/r/stats/oneway.test.html" class="external-link">oneway.test()</a></code> is reported.
Post-hoc analysis with <code><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD()</a></code> shows no significant
yield differences between blocks, as all share the same group label
(e.g., all green letters).</p>
</div>
<div class="section level5">
<h5 class="unnumbered" id="anova">ANOVA<a class="anchor" aria-label="anchor" href="#anova"></a>
</h5>
<p>The <code>InsectSprays</code> dataset reports insect counts from
agricultural experimental units treated with six different insecticides.
To stabilise the variance in counts, we apply a square root
transformation to the response variable.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">insect_sprays_tr</span> <span class="op">&lt;-</span> <span class="va">InsectSprays</span></span>
<span><span class="va">insect_sprays_tr</span><span class="op">$</span><span class="va">count_sqrt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">InsectSprays</span><span class="op">$</span><span class="va">count</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">insect_sprays_tr</span>, <span class="st">"count_sqrt"</span>, <span class="st">"spray"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-6-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-6-2.png" width="100%"></p>
<p>After the transformation, the homogeneity of variances can be assumed
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&gt;</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">p&gt; \alpha</annotation></semantics></math>
as calculated with the <code><a href="https://rdrr.io/r/stats/bartlett.test.html" class="external-link">bartlett.test()</a></code>), and the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
of the <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> is displayed.</p>
</div>
<div class="section level5">
<h5 class="unnumbered" id="kruskal-wallis-rank-sum-test">Kruskal-Wallis rank sum test<a class="anchor" aria-label="anchor" href="#kruskal-wallis-rank-sum-test"></a>
</h5>
<p>The <code>iris</code> dataset contains petal width measurements (in
cm) for three different iris species.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">iris</span>, <span class="st">"Petal.Width"</span>, <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-7-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-7-2.png" width="100%"></p>
<p>In this example, scatter plots of the standardised residuals and the
Q-Q plot suggest that the residuals are not normally distributed. This
is confirmed by very small
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-values
from both the Shapiro-Wilk and Anderson-Darling tests.</p>
<p>If both
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-values
are below the significance level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn><mo>−</mo></mrow><annotation encoding="application/x-tex">\alpha = 1 -</annotation></semantics></math>conf.level,
<code><a href="../reference/visstat.html">visstat()</a></code> switches to the non-parametric
<code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test()</a></code>. Post-hoc analysis using
<code><a href="https://rdrr.io/r/stats/pairwise.wilcox.test.html" class="external-link">pairwise.wilcox.test()</a></code> shows significant differences in
petal width between all three species, as indicated by distinct group
labels (all green letters differ).</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="simple-linear-regression">Simple linear regression<a class="anchor" aria-label="anchor" href="#simple-linear-regression"></a>
</h2>
<p>If the feature <code>varfactor</code> and the response
<code>varsample</code> have only one level of type
<code>numerical</code> or <code>integer</code>, <code><a href="../reference/visstat.html">visstat()</a></code>
performs a simple linear regression. Note that multiple linear
regression is <strong>not</strong> implemented, as the main focus of
<code><a href="../reference/visstat.html">visstat()</a></code> is the visualisation of statistical tests.</p>
<p>If the feature <code>varfactor</code> and the response
<code>varsample</code> contain only one level each and both are of type
<code>numeric</code> or <code>integer</code>, <code><a href="../reference/visstat.html">visstat()</a></code>
performs a simple linear regression. Note that multiple linear
regression is not implemented, as the main focus of
<code><a href="../reference/visstat.html">visstat()</a></code> is on the visualisation of statistical tests.</p>
<div class="section level3">
<h3 id="residual-analysis">Residual analysis<a class="anchor" aria-label="anchor" href="#residual-analysis"></a>
</h3>
<p><code><a href="../reference/visstat.html">visstat()</a></code> checks the normality of the standardised
residuals from <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> both graphically and using the
Shapiro-Wilk and Anderson-Darling tests (see also section <a href="#aov_residuals">Residual analysis</a>). If the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-values
for the null hypothesis of normally distributed residuals from both
tests are smaller than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo></mrow><annotation encoding="application/x-tex">1 -</annotation></semantics></math><code>conf.int</code>,
the title of the residual plot will display the message: “Requirement of
normally distributed residuals not met”.</p>
<p>Regardless of the result of the residual analysis,
<code><a href="../reference/visstat.html">visstat()</a></code> proceeds to perform the regression. The title of
the graphical output indicates the chosen confidence level
(<code>conf.level</code>), the estimated regression parameters with
their confidence intervals and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-values,
and the adjusted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>.
The plot displays the raw data, the fitted regression line, and both the
confidence and prediction bands corresponding to the specified
<code>conf.level</code>.</p>
<p><code><a href="../reference/visstat.html">visstat()</a></code> returns a list containing the regression test
statistics, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-values
from the normality tests of the standardised residuals, and the
pointwise estimates of the confidence and prediction bands.</p>
</div>
<div class="section level3">
<h3 id="examples-2">Examples<a class="anchor" aria-label="anchor" href="#examples-2"></a>
</h3>
<div class="section level4">
<h4 id="data-set-cars">Data set: <code class="unnumbered">cars</code><a class="anchor" aria-label="anchor" href="#data-set-cars"></a>
</h4>
<p>The <code>cars</code> dataset reports the speed of cars in miles per
hour (<code>speed</code>) and the stopping distance in feet
(<code>dist</code>).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linreg_cars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">cars</span>, <span class="st">"dist"</span>, <span class="st">"speed"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-8-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-8-2.png" width="100%"></p>
<p>Increasing the confidence level <code>conf.level</code> from the
default 0.95 to 0.99 results in wider confidence and prediction
bands:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linreg_cars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">cars</span>, <span class="st">"dist"</span>, <span class="st">"speed"</span>, conf.level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-9-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-9-2.png" width="100%"></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-values
greater than <code>conf.level</code> in both Anderson-Darling normality
test and the Shapiro-Wilk test of the standardised residuals indicate
that the normality assumption of the residuals underlying the linear
regression is met.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linreg_trees</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">trees</span>, <span class="st">"Volume"</span>, <span class="st">"Girth"</span>, conf.level <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-10-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-10-2.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="data-set-trees">Data set: <code class="unnumbered">trees</code><a class="anchor" aria-label="anchor" href="#data-set-trees"></a>
</h4>
<p>The <code>trees</code> dataset provides measurements of the diameter
(<code>Girth</code>, in inches), <code>Height</code> (in feet), and
<code>Volume</code> (in cubic feet) of black cherry trees. In this
example, we choose <code>Volume</code> as the response and
<code>Girth</code> as the feature.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linreg_cars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">trees</span>, <span class="st">"Volume"</span>, <span class="st">"Girth"</span>, conf.level <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-11-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-11-2.png" width="100%"></p>
<p>Both the graphical analysis of the standardised residuals and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-values
greater than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo></mrow><annotation encoding="application/x-tex">1 -</annotation></semantics></math>conf.level
in the Anderson-Darling and Shapiro-Wilk tests suggest that the
assumption of normally distributed residuals is met. Furthermore, the
linear regression model explains 93% of the total variance in the
response variable <code>Volume</code>.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="chi2--and-fisher-test">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">{\chi}^2</annotation></semantics></math>-
and Fisher Test<a class="anchor" aria-label="anchor" href="#chi2--and-fisher-test"></a>
</h2>
<p>When both the feature <code>varfactor</code> and the response
<code>varsample</code> are categorical variables (i.e., of type
<code>factor</code>), <code><a href="../reference/visstat.html">visstat()</a></code> tests the null hypothesis
that the two variables are independent. Categorical data are typically
represented as contingency tables, which cross-tabulate the observed
frequencies for each combination of factor levels. Based on these
observed frequencies, <code><a href="../reference/visstat.html">visstat()</a></code> computes the expected
frequencies under the null hypothesis of independence.</p>
<p>If the expected frequencies are sufficiently large - specifically, if
at least 80% of the cells have expected counts greater than 5 and no
expected count is zero - the function uses Pearson’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">{\chi}^2</annotation></semantics></math>-test
(<code><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test()</a></code>). Otherwise, it switches to Fisher’s exact
test (<code><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test()</a></code>) <span class="citation">(Cochran
1954)</span>. For 2-by-2 contingency tables, Yate’s a continuity
correction <span class="citation">(Yates 1934)</span> is applied to
Pearson’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">{\chi}^2</annotation></semantics></math>-test.</p>
<p>The function produces a grouped column plot that includes the test’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-value
in the title, as well as a mosaic plot showing Pearson residuals (see
the documentation of <code>mosaic()</code> in the <code>vcd</code>
package for details).</p>
<p>All features of <code><a href="../reference/visstat.html">visstat()</a></code> will be illustrated using the
built-in data set <code>HairEyeColor</code>.</p>
<div class="section level3">
<h3 id="data-preparation-transforming-a-contingency-table-to-data-frame">Data preparation: Transforming a contingency table to
<code>data.frame</code><a class="anchor" aria-label="anchor" href="#data-preparation-transforming-a-contingency-table-to-data-frame"></a>
</h3>
<p><code><a href="../reference/visstat.html">visstat()</a></code> requires input in the form of a column-based
<code>data.frame</code>. Contingency tables can be converted to this
format using the helper function <code><a href="../reference/counts_to_cases.html">counts_to_cases()</a></code>.</p>
<p><code><a href="../reference/counts_to_cases.html">counts_to_cases()</a></code> transforms the contingency table
<code>HairEyeColor</code> into <code>data.frame</code> named
<code>HairEyeColorDataFrame</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HairEyeColorDataFrame</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/counts_to_cases.html">counts_to_cases</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">HairEyeColor</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pearsons-chi2-test">Pearson’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">{\chi}^2</annotation></semantics></math>-test<a class="anchor" aria-label="anchor" href="#pearsons-chi2-test"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hair_eye_color_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/counts_to_cases.html">counts_to_cases</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">HairEyeColor</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">hair_eye_color_df</span>, <span class="st">"Hair"</span>, <span class="st">"Eye"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-13-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-13-2.png" width="100%"></p>
<div class="section level4">
<h4 id="pearsons-chi2-test-with-yates-continuity-correction">Pearson’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">{\chi}^2</annotation></semantics></math>-test
with Yate’s continuity correction<a class="anchor" aria-label="anchor" href="#pearsons-chi2-test-with-yates-continuity-correction"></a>
</h4>
<p>For 2-by-2 contingency tables, <code><a href="../reference/visstat.html">visstat()</a></code> applies Yate’s
continuity correction <span class="citation">(Yates 1934)</span> when
computing the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
test statistic. In the following example, we restrict the data to
participants with either black or brown hair and either brown or blue
eyes, resulting in a 2-by-2 contingency table.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hair_black_brown_eyes_brown_blue</span> <span class="op">&lt;-</span> <span class="va">HairEyeColor</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="op">]</span></span>
<span><span class="co">#Transform to data frame</span></span>
<span><span class="va">hair_black_brown_eyes_brown_blue_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/counts_to_cases.html">counts_to_cases</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">hair_black_brown_eyes_brown_blue</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#Chi-squared test</span></span>
<span><span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">hair_black_brown_eyes_brown_blue_df</span>, <span class="st">"Hair"</span>, <span class="st">"Eye"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-14-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-14-2.png" width="100%"></p>
</div>
</div>
<div class="section level3">
<h3 id="fishers-exact-test-and-mosaic-plot-with-pearson-residuals">Fisher’s exact test and mosaic plot with Pearson residuals<a class="anchor" aria-label="anchor" href="#fishers-exact-test-and-mosaic-plot-with-pearson-residuals"></a>
</h3>
<p>Again, we extract a 2-by-2 contingency table from the full dataset,
this time keeping only male participants with black or brown hair and
hazel or green eyes.</p>
<p>Pearson’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">{\chi}^2</annotation></semantics></math>
test applied to this table would yield an expected frequency less than 5
in one of the four cells (25% of all cells), which violates the
requirement that at least 80% of the expected frequencies must be 5 or
greater <span class="citation">(Cochran 1954)</span>.</p>
<p>Therefore, <code><a href="../reference/visstat.html">visstat()</a></code> automatically selects Fisher’s
exact test instead.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hair_eye_color_male</span> <span class="op">&lt;-</span> <span class="va">HairEyeColor</span><span class="op">[</span>, , <span class="fl">1</span><span class="op">]</span></span>
<span><span class="co"># Slice out a 2 by 2 contingency table</span></span>
<span><span class="va">black_brown_hazel_green_male</span> <span class="op">&lt;-</span> <span class="va">hair_eye_color_male</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="co">#Transform to data frame</span></span>
<span><span class="va">black_brown_hazel_green_male</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/counts_to_cases.html">counts_to_cases</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">black_brown_hazel_green_male</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Fisher test</span></span>
<span><span class="va">fisher_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">black_brown_hazel_green_male</span>, <span class="st">"Hair"</span>, <span class="st">"Eye"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-15-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-15-2.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="saving-the-graphical-output">Saving the graphical output<a class="anchor" aria-label="anchor" href="#saving-the-graphical-output"></a>
</h2>
<p>The generated graphics can be saved in any file format supported by
<code>Cairo()</code>, including “png”, “jpeg”, “pdf”, “svg”, “ps”, and
“tiff”. In the following example, we store the graphics in PNG format in
the <code>plotDirectory</code> <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>. The file names
reflect the statistical test used and the variable names involved.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">black_brown_hazel_green_male</span>, <span class="st">"Hair"</span>, <span class="st">"Eye"</span>,</span>
<span>graphicsoutput <span class="op">=</span> <span class="st">"png"</span>, plotDirectory <span class="op">=</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Remove the graphical output from <code>plotDirectory</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"chi_squared_or_fisher_Hair_Eye.png"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"mosaic_complete_Hair_Eye.png"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>```</p>
</div>
<div class="section level2">
<h2 id="overview-of-implemented-tests">Overview of implemented tests<a class="anchor" aria-label="anchor" href="#overview-of-implemented-tests"></a>
</h2>
<p><code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code>, <code><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test()</a></code>,
<code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code>, <code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test()</a></code>,
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>,<code><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test()</a></code>,
<code><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test()</a></code></p>
<div class="section level3">
<h3 id="implemented-tests-to-check-the-normal-distribution-of-standardised-residuals">Implemented tests to check the normal distribution of standardised
residuals<a class="anchor" aria-label="anchor" href="#implemented-tests-to-check-the-normal-distribution-of-standardised-residuals"></a>
</h3>
<p><code><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test()</a></code> and <code>ad.test()</code></p>
</div>
<div class="section level3">
<h3 id="implemented-post-hoc-tests">Implemented post-hoc tests<a class="anchor" aria-label="anchor" href="#implemented-post-hoc-tests"></a>
</h3>
<p><code><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD()</a></code> for <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> and
<code><a href="https://rdrr.io/r/stats/pairwise.wilcox.test.html" class="external-link">pairwise.wilcox.test()</a></code> for <code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test()</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Cochran" class="csl-entry">
Cochran, William G. and. 1954. <span>“<span class="nocase">The
combination of estimates from different experiments</span>.”</span>
<em>Scandinavian Journal of Statistics</em> 10 (1): 101–20. <a href="https://doi.org/10.2307/3001666" class="external-link">https://doi.org/10.2307/3001666</a>.
</div>
<div id="ref-Delacre:2017iv" class="csl-entry">
Delacre, M, D Lakens, C Leys International Review of Social, and 2017.
2017. <span>“<span class="nocase">Why Psychologists Should by Default
Use Welch’s t-test Instead of Student’s t-test</span>.”</span>
<em>International Review of Social Psychology</em>. <a href="https://doi.org/10.5334/irsp.82" class="external-link">https://doi.org/10.5334/irsp.82</a>.
</div>
<div id="ref-Holm1979ASS" class="csl-entry">
Holm, S. 1979. <span>“<span>A Simple Sequentially Rejective Multiple
Test Procedure</span>.”</span> <em>Scandinavian Journal of
Statistics</em> 6: 65–70.
</div>
<div id="ref-Lumley2002dsa" class="csl-entry">
Lumley, Thomas, Paula Diehr, Scott Emerson, and Lu Chen. 2002.
<span>“<span class="nocase">The importance of the normality assumption
in large public health data sets.</span>”</span> <em>Annual Review of
Public Health</em> 23: 151–69. <a href="https://doi.org/10.1146/annurev.publhealth.23.100901.140546" class="external-link">https://doi.org/10.1146/annurev.publhealth.23.100901.140546</a>.
</div>
<div id="ref-Moser:1992fp" class="csl-entry">
Moser, B K, and GR Stevens. 1992. <span>“<span class="nocase">Homogeneity of variance in the two-sample means
test</span>.”</span> <em>The American Statistician</em>, February,
19–21. <a href="https://doi.org/10.1080/00031305.1992.10475839" class="external-link">https://doi.org/10.1080/00031305.1992.10475839</a>.
</div>
<div id="ref-Rasch:2011vl" class="csl-entry">
Rasch, Dieter, Klaus D Kubinger, and Karl Moder. 2011. <span>“<span class="nocase">The two-sample t test: pre-testing its assumptions does
not pay off</span>.”</span> <em>Statistical Papers</em> 52 (1): 219–31.
<a href="https://doi.org/10.1007/s00362-009-0224-x" class="external-link">https://doi.org/10.1007/s00362-009-0224-x</a>.
</div>
<div id="ref-Sidak" class="csl-entry">
Šidák, Zbyněk. 1967. <span>“<span class="nocase">Rectangular Confidence
Regions for the Means of Multivariate Normal
Distributions</span>.”</span> <em>Journal of the American Statistical
Association</em> 62 (318): 626–33. <a href="https://doi.org/10.1080/01621459.1967.10482935" class="external-link">https://doi.org/10.1080/01621459.1967.10482935</a>.
</div>
<div id="ref-Yates:1934" class="csl-entry">
Yates, F. 1934. <span>“Contingency Tables Involving Small Numbers and
the Χ2 Test.”</span> <em>Supplement to the Journal of the Royal
Statistical Society</em> 1 (2): 217–35. <a href="https://doi.org/10.2307/2983604" class="external-link">https://doi.org/10.2307/2983604</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sabine Schilling.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
