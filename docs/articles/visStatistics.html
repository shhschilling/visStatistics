<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>visStatistics • visStatistics</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="visStatistics">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">visStatistics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/visStatistics.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/shhschilling/visStatistics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>visStatistics</h1>
                        <h4 data-toc-skip class="author">Sabine
Schilling</h4>
            
            <h4 data-toc-skip class="date">2025-05-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/shhschilling/visStatistics/blob/HEAD/vignettes/visStatistics.Rmd" class="external-link"><code>vignettes/visStatistics.Rmd</code></a></small>
      <div class="d-none name"><code>visStatistics.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/shhschilling/visStatistics/" class="external-link">visStatistics</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 class="unnumbered" id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h2>
<p>The R package <code>visStatistics</code> enables rapid visualization
and statistical analysis of raw data by automatically selecting the
hypothesis test with the highest statistical power to evaluate the
relationship between a dependent variable (<code>varsample</code>) and
an independent variable (<code>varfactor</code>) within a
data.frame.</p>
<p>A minimal function call has the following structure:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">dataframe</span>, <span class="va">varsample</span>, <span class="va">varfactor</span><span class="op">)</span></span></code></pre></div>
<p>The data must be structured in columns, with <code>varsample</code>
and <code>varfactor</code> being character strings naming the dependent
(response) and independent (feature) variables, respectively.</p>
<p>The choice of statistical test performed by the core function
<code><a href="../reference/visstat.html">visstat()</a></code> depends on whether the variables are numerical or
categorical, the number of levels in the categorical variable, and the
distribution characteristics (normal vs. non-normal).</p>
<p>In this vignette, data of <code>class</code> <code>"numeric"</code>
or <code>"integer"</code> are referred to as “numerical”, while data of
<code>class</code> <code>"factor"</code> are referred to as
“categorical”.</p>
<p>The function generates a graph showing the key statistics of the
selected test. The complete test statistics are also returned as part of
the output.</p>
<p>This vignette outlines the decision logic behind
<code><a href="../reference/visstat.html">visstat()</a></code>; the full parameter list is available via
<code><a href="../reference/visstat.html">?visstat</a></code>. A graphical representation of the the decision
tree for a categorical feature and a numeric response is given in
@ref(sec:decisiontree)</p>
<p>Note: All statistical tests use default settings except for the
user-adjustable <code>conf.level</code> parameter. As a consequence,
paired tests are not currently supported. Furthermore, as the main
purpose of this package is the visualization of statistical test
results, only simple linear regression is implemented.</p>
</div>
<div class="section level2">
<h2 id="comparing-central-tendencies">Comparing central tendencies<a class="anchor" aria-label="anchor" href="#comparing-central-tendencies"></a>
</h2>
<p>If the feature consists of data of <code>class</code>
<code>"factor"</code> with two or more levels and the response consists
of data of <code>class</code> <code>"numeric"</code> or
<code>"integer"</code> (both of mode <code>"numeric"</code>), tests are
applied to compare the central tendencies.</p>
<div class="section level3">
<h3 id="two-sample-tests-welchs-t-test-or-wilcoxon-rank-sum-test">Two sample tests: Welch’s t-test or Wilcoxon rank sum test<a class="anchor" aria-label="anchor" href="#two-sample-tests-welchs-t-test-or-wilcoxon-rank-sum-test"></a>
</h3>
<p>If the feature has exactly two levels, Welch’s t-test or its
non-parametric alternative, the Wilcoxon rank sum test, is performed.
Welch’s t-test evaluates the null hypothesis that the two groups have
equal means. While Student’s t-test assumes equal variances
(homoscedasticity), Welch’s t-test does not require this assumption. It
loses little robustness compared to Student’s t-test even when the
assumptions of Student’s t-test are met <span class="citation">(Moser
and Stevens 1992; Delacre et al., n.d.)</span>; therefore, Student’s
t-test is not implemented. The Wilcoxon rank sum test, on the other
hand, tests whether the two samples come from the same population or
have identical distributions, without assuming normality.</p>
<p>The test choice follows the algorithm below:</p>
<ul>
<li><p>If the sample size for both levels is greater than 30, always
perform Welch’s t-test (<code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code>) <span class="citation">(@
Rasch, Kubinger, and Moder 2011; Lumley et al. 2002)</span>. For large
samples, the t test has been shown to be robust in many situations o
test or not to test: Paper: Preliminary assessment of normality when
comparing two independent samples</p></li>
<li><p>If the sample size of at least one of the levels is smaller than
30, first check for normality of both levels with the Shapiro-Wilk
normality test (<code><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test()</a></code>):</p></li>
<li><p>If the p-values of the <code><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test()</a></code> of both levels
are greater than the error probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn><mo>−</mo></mrow><annotation encoding="application/x-tex">\alpha = 1-</annotation></semantics></math><code>conf.level</code>,
perform the Welch’s t-test (<code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code>).</p></li>
<li><p>If the p-value of at least one of the levels in the
<code><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test()</a></code> is smaller than the error probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn><mo>−</mo></mrow><annotation encoding="application/x-tex">\alpha=1-</annotation></semantics></math><code>conf.level</code>,
a Wilcoxon rank sum test (<code><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test()</a></code>) is
executed.</p></li>
</ul>
<p>The graphical representation consists of box plots overlaid with
jitter plots showing each data point. In the case of Welch’s t-test, the
<code>conf.level</code><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>⋅</mi><mn>100</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">\cdot 100 \%</annotation></semantics></math>
- confidence intervals are also shown. The test statistics of the chosen
test as well as the summary statistics of the generated box plots are
returned as a list.</p>
<div class="section level4">
<h4 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h4>
<div class="section level5">
<h5 id="welchs-t-test">Welch’s t-test<a class="anchor" aria-label="anchor" href="#welchs-t-test"></a>
</h5>
<p>As an example we use the motor trend car road test data set
(<code>mtcars)</code>, which consists of 32 observations. In the example
below <code>mpg</code> denotes miles per US gallon, <code>am</code> the
transmission type ((0 = automatic, 1 = manual)).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span><span class="op">)</span></span>
<span><span class="va">t_test_statistics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="st">"mpg"</span>, <span class="st">"am"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-2-1.png" width="100%"></p>
<p>Increasing the confidence level <code>conf.level</code> from the
default 0.95 to 0.99 results in wider confidence intervals:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span><span class="op">)</span></span>
<span><span class="va">t_test_statistics_99</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="st">"mpg"</span>, <span class="st">"am"</span>, conf.level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-3-1.png" width="100%"></p>
</div>
<div class="section level5">
<h5 id="wilcoxon-rank-sum-test">Wilcoxon rank sum test<a class="anchor" aria-label="anchor" href="#wilcoxon-rank-sum-test"></a>
</h5>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grades_gender</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"girl"</span>, <span class="fl">21</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"boy"</span>, <span class="fl">23</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>grade <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span><span class="fl">19.3</span>, <span class="fl">18.1</span>, <span class="fl">15.2</span>, <span class="fl">18.3</span>, <span class="fl">7.9</span>, <span class="fl">6.2</span>, <span class="fl">19.4</span>,</span>
<span><span class="fl">20.3</span>, <span class="fl">9.3</span>, <span class="fl">11.3</span>, <span class="fl">18.2</span>, <span class="fl">17.5</span>, <span class="fl">10.2</span>, <span class="fl">20.1</span>, <span class="fl">13.3</span>, <span class="fl">17.2</span>, <span class="fl">15.1</span>, <span class="fl">16.2</span>, <span class="fl">17.0</span>,</span>
<span><span class="fl">16.5</span>, <span class="fl">5.1</span>, <span class="fl">15.3</span>, <span class="fl">17.1</span>, <span class="fl">14.8</span>, <span class="fl">15.4</span>, <span class="fl">14.4</span>, <span class="fl">7.5</span>, <span class="fl">15.5</span>, <span class="fl">6.0</span>, <span class="fl">17.4</span>,</span>
<span><span class="fl">7.3</span>, <span class="fl">14.3</span>, <span class="fl">13.5</span>, <span class="fl">8.0</span>, <span class="fl">19.5</span>, <span class="fl">13.4</span>, <span class="fl">17.9</span>, <span class="fl">17.7</span>, <span class="fl">16.4</span>, <span class="fl">15.6</span>, <span class="fl">17.3</span>, <span class="fl">19.9</span>, <span class="fl">4.4</span>, <span class="fl">2.1</span></span>
<span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">wilcoxon_statistics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">grades_gender</span>, <span class="st">"grade"</span>, <span class="st">"sex"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="one-way-test-anova-or-kruskal-wallis-test">One-way test, ANOVA or Kruskal-Wallis test<a class="anchor" aria-label="anchor" href="#one-way-test-anova-or-kruskal-wallis-test"></a>
</h3>
<p>If the feature consists of data of <code>class</code>
<code>"factor"</code> with more than two levels and the response is of
<code>mode</code> <code>"numeric"</code>, <code><a href="../reference/visstat.html">visstat()</a></code>
performs an analysis of variance (ANOVA),if neither of the following
null hypotheses cannot be rejected on the chosen
<code>conf.level</code>:</p>
<ol style="list-style-type: decimal">
<li>normality of the standardised residuals and</li>
<li>homoscedasticity.</li>
</ol>
<p>If only the first condition for the normality of the residuals is
met, <code><a href="../reference/visstat.html">visstat()</a></code> performs a one-way test (see
<code><a href="https://rdrr.io/r/stats/oneway.test.html" class="external-link">oneway.test()</a></code>). If the normality of the residuals cannot be
assumed, a Kruskal-Wallis test (<code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test()</a></code>) is used.
These assumptions are tested by the <code>visAnovaAssumptions()</code>
function.</p>
<div class="section level4">
<h4 id="checking-the-anova-assumptions">Checking the ANOVA assumptions<a class="anchor" aria-label="anchor" href="#checking-the-anova-assumptions"></a>
</h4>
<div class="section level5">
<h5 id="aov_residuals">Residual analysis<a class="anchor" aria-label="anchor" href="#aov_residuals"></a>
</h5>
<p>The <code>visAnovaAssumptions()</code> function assesses the
normality of standardized residuals from the ANOVA fit using both the
Shapiro-Wilk test (<code><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test()</a></code>) and the Anderson-Darling
test (<code>ad.test())</code>.</p>
<p>It plots the standardised residuals against the fitted means of the
linear model for each level of the feature <code>varfactor</code>and
generates the Q-Q plot of the standardised residuals.</p>
</div>
<div class="section level5">
<h5 id="homoscedasticity-homogeneity-of-variances-in-each-level-bartlett-test">Homoscedasticity: homogeneity of variances in each level: Bartlett
test<a class="anchor" aria-label="anchor" href="#homoscedasticity-homogeneity-of-variances-in-each-level-bartlett-test"></a>
</h5>
<p>Both <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> and <code><a href="https://rdrr.io/r/stats/oneway.test.html" class="external-link">oneway.test()</a></code> test whether
two or more samples from normal distributions have the same mean. While
<code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> requires homogeneity of variances in each level
(group), the <code><a href="https://rdrr.io/r/stats/oneway.test.html" class="external-link">oneway.test()</a></code> does not require that the
variances in each level are necessarily equal. Homoscedasticity is
assessed using the Bartlett test, see <code><a href="https://rdrr.io/r/stats/bartlett.test.html" class="external-link">bartlett.test()</a></code>,
under the null hypothesis that the variances in each of the levels are
equal.</p>
</div>
</div>
<div class="section level4">
<h4 id="one-way-test-and-anova">One-way test and ANOVA<a class="anchor" aria-label="anchor" href="#one-way-test-and-anova"></a>
</h4>
<p>Depending on the p-value of the <code><a href="https://rdrr.io/r/stats/bartlett.test.html" class="external-link">bartlett.test()</a></code>, the
corresponding test is shown in the figure title:</p>
<ul>
<li><p>If the p-value of the <code><a href="https://rdrr.io/r/stats/bartlett.test.html" class="external-link">bartlett.test()</a></code> is greater
than <code>1-conf.level</code>, we assume homogeneity of variances in
each level (group) and the p-values of <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> are
displayed.</p></li>
<li><p>Otherwise homoscedasticity cannot be assumed and the p-value of
<code><a href="https://rdrr.io/r/stats/oneway.test.html" class="external-link">oneway.test()</a></code> is reported.</p></li>
</ul>
<div class="section level5">
<h5 id="post-hoc-analysis-tukeys-honestly-significant-differences-hsd-and-sidak-corrected-confidence-intervals">Post-hoc analysis: Tukey’s honestly significant differences (HSD)
and Sidak corrected confidence intervals<a class="anchor" aria-label="anchor" href="#post-hoc-analysis-tukeys-honestly-significant-differences-hsd-and-sidak-corrected-confidence-intervals"></a>
</h5>
<p>Simple multiple comparisons of the means for the factor levels in an
analysis of variance inflate the probability of declaring a significant
difference when, in fact, there is none . The family-wise error rate
(also called the probability of a type I error) is the probability of at
least one false positive comparison, in which the null hypothesis is
falsely rejected, when multiple comparisons are performed.</p>
<div class="section level6">
<h6 id="tukeys-honestly-significant-differences-hsd">Tukey`s honestly significant differences (HSD)<a class="anchor" aria-label="anchor" href="#tukeys-honestly-significant-differences-hsd"></a>
</h6>
<p>The <code><a href="../reference/visstat.html">visstat()</a></code> function reduces the probability of a type
I error by applying Tukey’s Honestly Significant Differences as
implemented in <code><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD()</a></code>. Based on the specified
confidence level <code>conf.level</code>, it constructs a set of
confidence intervals for all pairwise differences between factor level
means. A significant difference between two means is indicated when the
corresponding confidence interval does not include the zero. The
function returns both the confidence intervals and the Tukey
HSD-adjusted p-values for all pairwise comparisons.</p>
<p>In the graphical representation of One-way test and ANOVA, green
letters between two factor levels differ only, if the Tukey’s HSD
adjusted p-value for their comparison is smaller than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn><mo>−</mo></mrow><annotation encoding="application/x-tex">\alpha=1-</annotation></semantics></math><code>conf.int</code>.</p>
</div>
</div>
<div class="section level5">
<h5 id="sidak-corrected-confidence-intervals">Sidak corrected confidence intervals<a class="anchor" aria-label="anchor" href="#sidak-corrected-confidence-intervals"></a>
</h5>
<p>Tukey`s HSD procedure is based on <strong>pairwise</strong>
comparisons of the differences between the means at each factor level
and produces a set of corresponding confidence intervals. The Sidak
procedure, on the other hand, addresses the problems of a type I error
by lowering the acceptable probability of a type I error for
<strong>all</strong> comparisons of the levels of the independent,
categorical variable.</p>
<p>The Sidak corrected acceptable probability of error <span class="citation">(Šidák 1967)</span> is defined as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mrow><mi>S</mi><mi>i</mi><mi>d</mi><mi>a</mi><mi>k</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\alpha_{Sidak}=1</annotation></semantics></math>-<code>conf.int</code><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mrow><mn>1</mn><mi>/</mi><mi>M</mi></mrow></msup><annotation encoding="application/x-tex">^{1/M}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mfrac><mrow><mi>n</mi><mo>⋅</mo><mo stretchy="false" form="prefix">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">M=\frac{n\cdot (n-1)}{2}</annotation></semantics></math>
is the number of pairwise comparisons of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
levels of the categorical variable.</p>
<p>In the graphical display of One-way test and ANOVA,
<code><a href="../reference/visstat.html">visstat()</a></code> displays both the <code>conf.level</code>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>⋅</mi><mspace width="0.278em"></mspace><mn>100</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">\cdot\; 100 \%</annotation></semantics></math>
confidence intervals alongside the larger, Sidak-corrected
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>α</mi><mrow><mi>S</mi><mi>i</mi><mi>d</mi><mi>a</mi><mi>k</mi></mrow></msub><mo stretchy="false" form="postfix">)</mo><mo>⋅</mo><mn>100</mn><mspace width="0.278em"></mspace><mi>%</mi></mrow><annotation encoding="application/x-tex">(1-\alpha_{Sidak})\cdot 100\;\%</annotation></semantics></math>
confidence intervals.</p>
</div>
<div class="section level5">
<h5 id="limitations">Limitations<a class="anchor" aria-label="anchor" href="#limitations"></a>
</h5>
<p>Note that the current structure of <code><a href="../reference/visstat.html">visstat()</a></code> does not
allow the study of interactions between the different levels of an
independent variable.</p>
</div>
</div>
<div class="section level4">
<h4 id="kruskal-wallis-test">Kruskal-Wallis test<a class="anchor" aria-label="anchor" href="#kruskal-wallis-test"></a>
</h4>
<p>If the p-value of the standardised residuals computed by
<code><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test()</a></code> is smaller than the significance
level<code>1-conf.level</code>, <code><a href="../reference/visstat.html">visstat()</a></code> chooses a
non-parametric alternative, the Kruskal-Wallis rank sum test.
<code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test()</a></code> tests the null that the medians are equal at
each group level.</p>
<div class="section level5">
<h5 id="post-hoc-analysis-pairwise-wilcox-test">Post-hoc analysis: <code>pairwise.wilcox.test()</code><a class="anchor" aria-label="anchor" href="#post-hoc-analysis-pairwise-wilcox-test"></a>
</h5>
<p>As post-hoc-analysis the pairwise Wilcoxon rank sum test
<code><a href="https://rdrr.io/r/stats/pairwise.wilcox.test.html" class="external-link">pairwise.wilcox.test()</a></code> is used, applying the default Holm
method for multiple comparisons<span class="citation">(Holm
1979)</span>. If the Holm-adjusted p-value for a pair is smaller than
the significance level <code>1-conf.level</code>, the green letters
under the corresponding two box plots will differ. Otherwise the
graphical representation of the Kruskal-Wallis test is similar to the
Wilcoxon rank sum test described above. A list with the test statistics
of the Kruskal-Wallis rank sum test and the p-values of the pairwise
comparisons adjusted by the Holm method is returned.</p>
</div>
</div>
<div class="section level4">
<h4 id="examples-1">Examples<a class="anchor" aria-label="anchor" href="#examples-1"></a>
</h4>
<div class="section level5">
<h5 class="unnumbered" id="one-way-test">One-way test:<a class="anchor" aria-label="anchor" href="#one-way-test"></a>
</h5>
<p>The <code>npk</code> dataset reports the yield of peas in
pounds/block on six blocks, where the application of nitrogen (N),
phosphate (P) or potassium (K) fertilisers was varied. Either no, one,
two or three different fertilisers were applied on the blocks.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oneway_npk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">npk</span>, <span class="st">"yield"</span>, <span class="st">"block"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-5-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-5-2.png" width="100%"></p>
<p>We can assume that the residuals are normally distributed based on
the scatterplots of the standardised residuals, the normal
quantile-quantile plot (Q-Q plot), and the p-values of both the
Shapiro-Wilk test and the Anderson-Darling test. But at the given
confidence level the homogeneity of variances cannot be assumed
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&lt;</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">p&lt; \alpha</annotation></semantics></math>
as calculated with the <code><a href="https://rdrr.io/r/stats/bartlett.test.html" class="external-link">bartlett.test()</a></code>), and the p-value of
the <code><a href="https://rdrr.io/r/stats/oneway.test.html" class="external-link">oneway.test()</a></code> is displayed.</p>
<p>Post-hoc analysis with <code><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD()</a></code> shows no significant
difference between the yield between the different blocks (all green
letters are equal).</p>
</div>
<div class="section level5">
<h5 class="unnumbered" id="anova">ANOVA<a class="anchor" aria-label="anchor" href="#anova"></a>
</h5>
<p>The InsectSprays data gives the counts of insects in agricultural
experimental units treated with six different insecticides. To stabilise
the variance in counts, we transform the count data of the
<code>InsectSprays</code> data set by the square root.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">insect_sprays_tr</span> <span class="op">&lt;-</span> <span class="va">InsectSprays</span></span>
<span><span class="va">insect_sprays_tr</span><span class="op">$</span><span class="va">count_sqrt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">InsectSprays</span><span class="op">$</span><span class="va">count</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">insect_sprays_tr</span>, <span class="st">"count_sqrt"</span>, <span class="st">"spray"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-6-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-6-2.png" width="100%"></p>
<p>After the transformation, the homogeneity of variances can be assumed
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>&gt;</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">p&gt; \alpha</annotation></semantics></math>
as calculated with the <code><a href="https://rdrr.io/r/stats/bartlett.test.html" class="external-link">bartlett.test()</a></code>), and the p-value of
the <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> is displayed.</p>
</div>
<div class="section level5">
<h5 class="unnumbered" id="kruskal-wallis-rank-sum-test">Kruskal-Wallis rank sum test<a class="anchor" aria-label="anchor" href="#kruskal-wallis-rank-sum-test"></a>
</h5>
<p>The iris data set gives the measurement of the petal width in cm for
three different iris species.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">iris</span>, <span class="st">"Petal.Width"</span>, <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-7-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-7-2.png" width="100%"></p>
<p>In the iris data example, the graphical analysis of the scatter plots
of the standardised residuals as well as the Q-Q plot suggest that the
residuals are not normally distributed. This visual inspection is
confirmed by the very small p-values of the implemented tests of
normality, the Shapiro-Wilk test and the Anderson-Darling test.</p>
<p>If both p-values are below the significance level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn><mo>−</mo></mrow><annotation encoding="application/x-tex">\alpha = 1 -</annotation></semantics></math>conf.level,
<code><a href="../reference/visstat.html">visstat()</a></code> switches to the non-parametric alternative
<code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test()</a></code>. Post-hoc analysis with
<code><a href="https://rdrr.io/r/stats/pairwise.wilcox.test.html" class="external-link">pairwise.wilcox.test()</a></code> reveals significant differences
between the petal width of all three species (all green letters
differ).</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="linear-regression">Linear Regression<a class="anchor" aria-label="anchor" href="#linear-regression"></a>
</h2>
<p>If the feature <code>varfactor</code> and the response
<code>varsample</code> have only one level of type
<code>numerical</code> or <code>integer</code>, <code><a href="../reference/visstat.html">visstat()</a></code>
performs a simple linear regression.</p>
<div class="section level3">
<h3 id="residual-analysis">Residual analysis<a class="anchor" aria-label="anchor" href="#residual-analysis"></a>
</h3>
<p><code><a href="../reference/visstat.html">visstat()</a></code> checks the normal distribution of the
standardised residuals derived from <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> both graphically
and with the Shapiro-Wilk and Anderson test (analogue to section <a href="#aov_residuals">Residual analysis</a>). If the p-values of the
null that the standardised residuals are normally distributed of both
Shapiro-Wilk and Anderson test are smaller than 1-<code>conf.int</code>,
the title of the residual plot will display the message “Requirement of
normally distributed residuals not met”.</p>
<p>Regardless of the result of the residual analysis,
<code><a href="../reference/visstat.html">visstat()</a></code> performs the regression itself in the next step.
The title of the graphical output indicates the chosen confidence level
<code>conf.level</code>,the regression parameter with their confidence
intervals and p-values, and the adjusted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>.
The graph shows the raw data, the regression line and both the
confidence and prediction bands corresponding to the chosen
<code>conf.level</code>. <code><a href="../reference/visstat.html">visstat()</a></code> returns a list with the
test statistics of the linear regression, the p-values of the normality
tests of the standardised residuals and the pointwise estimates of the
confidence and prediction bands.</p>
</div>
<div class="section level3">
<h3 id="examples-2">Examples<a class="anchor" aria-label="anchor" href="#examples-2"></a>
</h3>
<div class="section level4">
<h4 id="data-set-cars">Data set: cars<a class="anchor" aria-label="anchor" href="#data-set-cars"></a>
</h4>
<p>The cars data set reports the speed of cars in mph and the distance
(dist) in ft taken to stop.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linreg_cars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">cars</span>, <span class="st">"dist"</span>, <span class="st">"speed"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-8-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-8-2.png" width="100%"></p>
<p>Increasing the confidence level <code>conf.level</code> from the
default 0.95 to 0.99 results in wider confidence and prediction
bands:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linreg_cars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">cars</span>, <span class="st">"dist"</span>, <span class="st">"speed"</span>, conf.level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-9-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-9-2.png" width="100%"></p>
<p>p-values greater than <code>conf.level</code> in both
Anderson-Darling normality test and the Shapiro-Wilk test of the
standardised residuals indicate that the normality assumption of the
residuals underlying the linear regression is met.</p>
</div>
<div class="section level4">
<h4 id="data-set-trees">Data set: trees<a class="anchor" aria-label="anchor" href="#data-set-trees"></a>
</h4>
<p>The trees data set provides measurements of the diameter (called
“Girth”) in inches and height in feet of black cherry trees.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linreg_cars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">trees</span>, <span class="st">"Height"</span>, <span class="st">"Girth"</span>, conf.level <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-10-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-10-2.png" width="100%"></p>
<p>Both the graphical analysis of the standardised residuals and
p-values less than 1-<code>conf.level</code> in the Anderson-Darling
normality test and the Shapiro-Wilk test of the standardised residuals
suggest that the condition of normally distributed residuals of the
regression model is not met. Furthermore the linear regression model
explains only 24% of the total variance of the dependent variables
“Height” of the cherry trees. The user might consider other regression
models. These further tests are not provided by
<code><a href="../reference/visstat.html">visstat()</a></code>.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="chi2--and-fisher-test">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">{\chi}^2</annotation></semantics></math>-
and Fisher Test<a class="anchor" aria-label="anchor" href="#chi2--and-fisher-test"></a>
</h2>
<p>If both the feature <code>varfactor</code> and the response are
<code>varsample</code> are categorical of type <code>factor</code>,
<code><a href="../reference/visstat.html">visstat()</a></code> tests the null hypothesis, that the feature and
the response are independent of each other.</p>
<p>Categorical data are usually presented as multidimensional arrays,
called contingency tables. The values in each cell of the contingency
table are the observed frequencies for each unique combination of
feature and response. Based on the observed frequencies,
<code><a href="../reference/visstat.html">visstat()</a></code> calculates the expected frequencies under the
null hypothesis.</p>
<p>If the expected frequencies are large, where large is defined as at
least 80% of the expected frequencies being greater than 5 and none of
the expected frequencies being less than 1, the
<code>chisqu.test()</code> is performed, otherwise the
<code><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test()</a></code> <span class="citation">(Cochran 1954)</span>.
In the case of 2-by-2 contingency tables, the continuity correction is
applied to the<code>chisqu.test()\</code>.</p>
<p><code><a href="../reference/visstat.html">visstat()</a></code> prints a grouped column plot with the p-value
of the corresponding test in the title and a mosaic plot with Pearson’s
residuals (for details see documentation of function
<code>mosaic()</code> in the <code>vcd</code> package ) are
generated.</p>
<div class="section level3">
<h3 id="converting-a-contingency-tables-to-a-data-frame-">Converting a contingency tables to a <code>data.frame</code>.<a class="anchor" aria-label="anchor" href="#converting-a-contingency-tables-to-a-data-frame-"></a>
</h3>
<p><code><a href="../reference/visstat.html">visstat()</a></code> needs a <code>data.frame</code> with a column
structure as input. Contingency tables can be transformed into this
structure with the helper function <code><a href="../reference/counts_to_cases.html">counts_to_cases()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="examples-based-on-data-set-haireyecolor">Examples based on data set: HairEyeColor<a class="anchor" aria-label="anchor" href="#examples-based-on-data-set-haireyecolor"></a>
</h3>
<div class="section level4">
<h4 id="creating-a-data-frame-from-a-contingency-table">Creating a <code>data.frame</code> from a contingency table<a class="anchor" aria-label="anchor" href="#creating-a-data-frame-from-a-contingency-table"></a>
</h4>
<p><code><a href="../reference/counts_to_cases.html">counts_to_cases()</a></code> transforms the contingency table
<code>HairEyeColor</code> into <code>data.frame</code> named
<code>HairEyeColorDataFrame</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HairEyeColorDataFrame</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/counts_to_cases.html">counts_to_cases</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">HairEyeColor</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="pearsons-chi-squared-test">Pearson’s Chi-squared test<a class="anchor" aria-label="anchor" href="#pearsons-chi-squared-test"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hair_eye_color_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/counts_to_cases.html">counts_to_cases</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">HairEyeColor</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">hair_eye_color_df</span>, <span class="st">"Hair"</span>, <span class="st">"Eye"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-12-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-12-2.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="pearsons-chi-squared-test-with-yates-continuity-correction">Pearson’s Chi-squared test with Yate’s continuity correction<a class="anchor" aria-label="anchor" href="#pearsons-chi-squared-test-with-yates-continuity-correction"></a>
</h4>
<p>For 2 by 2 contingency tables, <code><a href="../reference/visstat.html">visstat()</a></code> applies the
continuity correction to the test statistics of the Chi-squared
test.</p>
<p>In the following example, we select only participants with black or
brown hair and brown or blue eyes resulting in a 2 by 2 contingency
table.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hair_black_brown_eyes_brown_blue</span> <span class="op">&lt;-</span> <span class="va">HairEyeColor</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="op">]</span></span>
<span><span class="co">#Transform to data frame</span></span>
<span><span class="va">hair_black_brown_eyes_brown_blue_df</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/counts_to_cases.html">counts_to_cases</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">hair_black_brown_eyes_brown_blue</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#Chi-squared test</span></span>
<span><span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">hair_black_brown_eyes_brown_blue_df</span>, <span class="st">"Hair"</span>, <span class="st">"Eye"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-13-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-13-2.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="fishers-exact-test-and-mosaic-plot-with-pearson-residuals">Fisher’s exact test and mosaic plot with Pearson residuals<a class="anchor" aria-label="anchor" href="#fishers-exact-test-and-mosaic-plot-with-pearson-residuals"></a>
</h4>
<p>Again, we cut a 2 x2 contingency table from the full data set, this
time only keeping only male participants with black or brown hair and
hazel or green eyes. Pearson’s Chi-squared on this 2 x2 contingency
table would give to an expected value less than 5 in one of the four
cells (corresponding to 25% of all cells), violating the requirement of
the Chi-squared test that the expected value should be at least 5 for
the majority (80%) of the cells <span class="citation">(Cochran
1954)</span>. Therefore the Fisher exact test is chosen.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hair_eye_color_male</span> <span class="op">&lt;-</span> <span class="va">HairEyeColor</span><span class="op">[</span>, , <span class="fl">1</span><span class="op">]</span></span>
<span><span class="co"># Slice out a 2 by 2 contingency table</span></span>
<span><span class="va">black_brown_hazel_green_male</span> <span class="op">&lt;-</span> <span class="va">hair_eye_color_male</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="co">#Transform to data frame</span></span>
<span><span class="va">black_brown_hazel_green_male</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/counts_to_cases.html">counts_to_cases</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">black_brown_hazel_green_male</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Fisher test</span></span>
<span><span class="va">fisher_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">black_brown_hazel_green_male</span>, <span class="st">"Hair"</span>, <span class="st">"Eye"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visStatistics_files/figure-html/unnamed-chunk-14-1.png" width="100%"><img src="visStatistics_files/figure-html/unnamed-chunk-14-2.png" width="100%"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="saving-the-graphical-output">Saving the graphical output<a class="anchor" aria-label="anchor" href="#saving-the-graphical-output"></a>
</h2>
<p>The generated graphics can be saved in the file formats supported by
<code>Cairo():</code> “png”, “jpeg”, “pdf”, “svg”, “ps” and “tiff”. In
the following example we store the graphics files in the output format
“png” to the <code>plotDirectory</code> <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>. The
naming convention used for the graphics file reflects the chosen
statistical test and the variable names.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/visstat.html">visstat</a></span><span class="op">(</span><span class="va">black_brown_hazel_green_male</span>, <span class="st">"Hair"</span>, <span class="st">"Eye"</span>,</span>
<span>graphicsoutput <span class="op">=</span> <span class="st">"png"</span>, plotDirectory <span class="op">=</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Remove the graphical output from <code>plotDirectory</code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"chi_squared_or_fisher_Hair_Eye.png"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"mosaic_complete_Hair_Eye.png"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sec-decisiontree">Decision tree for categorical feature and numerical response<a class="anchor" aria-label="anchor" href="#sec-decisiontree"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html" class="external-link">include_graphics</a></span><span class="op">(</span><span class="st">"figures/decision_tree_v6.pdf"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<embed src="figures/decision_tree_v6.pdf" title="Decision tree used to select the appropriate statistical test for a categorical predictor and numerical response, based on the number of factor levels, normality and homoscedasticity." width="100%" type="application/pdf"></embed><p class="caption">
Decision tree used to select the appropriate statistical test for a
categorical predictor and numerical response, based on the number of
factor levels, normality and homoscedasticity.
</p>
</div>
</div>
<div class="section level2">
<h2 id="overview-of-implemented-tests">Overview of implemented tests<a class="anchor" aria-label="anchor" href="#overview-of-implemented-tests"></a>
</h2>
<p><code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code>, <code><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test()</a></code>,
<code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code>, <code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test()</a></code>,
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>,<code><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test()</a></code>,
<code><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test()</a></code></p>
<div class="section level3">
<h3 id="implemented-tests-to-check-the-normal-distribution-of-standardised-residuals">Implemented tests to check the normal distribution of standardised
residuals<a class="anchor" aria-label="anchor" href="#implemented-tests-to-check-the-normal-distribution-of-standardised-residuals"></a>
</h3>
<p><code><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test()</a></code> and <code>ad.test()</code></p>
</div>
<div class="section level3">
<h3 id="implemented-post-hoc-tests">Implemented post-hoc tests<a class="anchor" aria-label="anchor" href="#implemented-post-hoc-tests"></a>
</h3>
<p><code><a href="https://rdrr.io/r/stats/TukeyHSD.html" class="external-link">TukeyHSD()</a></code> for <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> and
<code><a href="https://rdrr.io/r/stats/pairwise.wilcox.test.html" class="external-link">pairwise.wilcox.test()</a></code> for <code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test()</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Cochran" class="csl-entry">
Cochran, William G. and. 1954. <span>“<span class="nocase">The
combination of estimates from different experiments</span>.”</span>
<em>Scandinavian Journal of Statistics</em> 10 (1): 101–20. <a href="https://doi.org/10.2307/3001666" class="external-link">https://doi.org/10.2307/3001666</a>.
</div>
<div id="ref-Delacre:2017iv" class="csl-entry">
Delacre, M, D Lakens, C Leys International Review of Social, and 2017.
n.d. <span>“<span class="nocase">Why Psychologists Should by Default Use
Welch’s t-test Instead of Student’s t-test</span>.”</span>
<em>International Review of Social Psychology</em>. <a href="https://doi.org/10.5334/irsp.82" class="external-link">https://doi.org/10.5334/irsp.82</a>.
</div>
<div id="ref-Holm1979ASS" class="csl-entry">
Holm, S. 1979. <span>“<span>A Simple Sequentially Rejective Multiple
Test Procedure</span>.”</span> <em>Scandinavian Journal of
Statistics</em> 6: 65–70.
</div>
<div id="ref-Lumley2002dsa" class="csl-entry">
Lumley, Thomas, Paula Diehr, Scott Emerson, and Lu Chen. 2002.
<span>“<span class="nocase">The importance of the normality assumption
in large public health data sets.</span>”</span> <em>Annual Review of
Public Health</em> 23: 151–69. <a href="https://doi.org/10.1146/annurev.publhealth.23.100901.140546" class="external-link">https://doi.org/10.1146/annurev.publhealth.23.100901.140546</a>.
</div>
<div id="ref-Moser:1992fp" class="csl-entry">
Moser, B K, and GR Stevens. 1992. <span>“<span class="nocase">Homogeneity of variance in the two-sample means
test</span>.”</span> <em>The American Statistician</em>, February,
19–21. <a href="https://doi.org/10.1080/00031305.1992.10475839" class="external-link">https://doi.org/10.1080/00031305.1992.10475839</a>.
</div>
<div id="ref-Rasch:2011vl" class="csl-entry">
Rasch, Dieter, Klaus D Kubinger, and Karl Moder. 2011. <span>“<span class="nocase">The two-sample t test: pre-testing its assumptions does
not pay off</span>.”</span> <em>Statistical Papers</em> 52 (1): 219–31.
<a href="https://doi.org/10.1007/s00362-009-0224-x" class="external-link">https://doi.org/10.1007/s00362-009-0224-x</a>.
</div>
<div id="ref-Sidak" class="csl-entry">
Šidák, Zbyněk. 1967. <span>“<span class="nocase">Rectangular Confidence
Regions for the Means of Multivariate Normal
Distributions</span>.”</span> <em>Journal of the American Statistical
Association</em> 62 (318): 626–33. <a href="https://doi.org/10.1080/01621459.1967.10482935" class="external-link">https://doi.org/10.1080/01621459.1967.10482935</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sabine Schilling.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
