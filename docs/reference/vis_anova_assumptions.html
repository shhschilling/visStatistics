<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Testing ANOVA assumptions — vis_anova_assumptions • visStatistics</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Testing ANOVA assumptions — vis_anova_assumptions" />
<meta property="og:description" content="vis_anova_assumptions() checks for normality of the standardised residuals of the anova both graphically 
   the Shapiro-Wilk-test shapiro.test() and the Anderson-Darling-Test ad.test().
   It further tests the homoscedacity of each factor level in fact with the bartlett.test().
   It generates plots of the standardized residuals versus the fitted mean values of the linear models for each level of fact. 
   Furthermore it shows the  normal QQ plot of the standardized residuals." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">visStatistics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/visStatistics-vignette.html">visStatistics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Testing ANOVA assumptions</h1>
    
    <div class="hidden name"><code>vis_anova_assumptions.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>vis_anova_assumptions()</code> checks for normality of the standardised residuals of the anova both graphically 
   the Shapiro-Wilk-test <code><a href='https://rdrr.io/r/stats/shapiro.test.html'>shapiro.test()</a></code> and the Anderson-Darling-Test <code>ad.test()</code>.
   It further tests the homoscedacity of each factor level in <code>fact</code> with the <code><a href='https://rdrr.io/r/stats/bartlett.test.html'>bartlett.test()</a></code>.
   It generates plots of the standardized residuals versus the fitted mean values of the linear models for each level of <code>fact</code>. 
   Furthermore it shows the  normal QQ plot of the standardized residuals.</p>
    </div>

    <pre class="usage"><span class='fu'>vis_anova_assumptions</span><span class='op'>(</span>
  <span class='va'>samples</span>,
  <span class='va'>fact</span>,
  conf.level <span class='op'>=</span> <span class='fl'>0.95</span>,
  samplename <span class='op'>=</span> <span class='st'>""</span>,
  factorname <span class='op'>=</span> <span class='st'>""</span>,
  cex <span class='op'>=</span> <span class='fl'>1</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>samples</th>
      <td><p>vector containing dependent variable, datatype numeric</p></td>
    </tr>
    <tr>
      <th>fact</th>
      <td><p>vector containing independent variable, datatype factor</p></td>
    </tr>
    <tr>
      <th>conf.level</th>
      <td><p>confidence level, 0.95=default</p></td>
    </tr>
    <tr>
      <th>samplename</th>
      <td><p>name of sample used in graphical output, dataype character , ""=default</p></td>
    </tr>
    <tr>
      <th>factorname</th>
      <td><p>name of sample used in graphical output, dataype character, ""=default</p></td>
    </tr>
    <tr>
      <th>cex</th>
      <td><p>number indicating the amount by which plotting text and symbols should be scaled relative to the default. 1=default, 1.5 is 50% larger, 0.5 is 50% smaller, etc.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>my_list: list containing the test statistics of the anova
<code>aov(samples~fact)</code>,<code>bartlett.test(samples~fact)</code> and the tests of normality of the standardized residuals of aov, <code>ks_test</code> and <code>shapiro_test</code></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='va'>ToothGrowth</span><span class='op'>$</span><span class='va'>dose</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>ToothGrowth</span><span class='op'>$</span><span class='va'>dose</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'>vis_anova_assumptions</span><span class='op'>(</span><span class='va'>ToothGrowth</span><span class='op'>$</span><span class='va'>len</span>, <span class='va'>ToothGrowth</span><span class='op'>$</span><span class='va'>dose</span><span class='op'>)</span></span>
<span class='r-plt'><img src='vis_anova_assumptions-1.png' alt='' width='700' height='433' /></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $shapiro_test</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 	Shapiro-Wilk normality test</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> data:  rstandard(anova)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> W = 0.96731, p-value = 0.1076</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $ad_test</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 	Anderson-Darling normality test</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> data:  rstandard(anova)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> A = 0.68679, p-value = 0.06928</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $summary_anova</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>             Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> fact         2   2426    1213   67.42 9.53e-16 ***</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Residuals   57   1026      18                     </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> ---</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $bartlett_test</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 	Bartlett test of homogeneity of variances</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> data:  samples by fact</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Bartlett's K-squared = 0.66547, df = 2, p-value = 0.717</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'>vis_anova_assumptions</span><span class='op'>(</span><span class='va'>ToothGrowth</span><span class='op'>$</span><span class='va'>len</span>, <span class='va'>ToothGrowth</span><span class='op'>$</span><span class='va'>supp</span><span class='op'>)</span></span>
<span class='r-plt'><img src='vis_anova_assumptions-2.png' alt='' width='700' height='433' /></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $shapiro_test</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 	Shapiro-Wilk normality test</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> data:  rstandard(anova)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> W = 0.96949, p-value = 0.1378</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $ad_test</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 	Anderson-Darling normality test</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> data:  rstandard(anova)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> A = 0.51449, p-value = 0.185</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $summary_anova</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>             Df Sum Sq Mean Sq F value Pr(&gt;F)  </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> fact         1    205  205.35   3.668 0.0604 .</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Residuals   58   3247   55.98                 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> ---</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $bartlett_test</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 	Bartlett test of homogeneity of variances</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> data:  samples by fact</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Bartlett's K-squared = 1.4217, df = 1, p-value = 0.2331</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-in'><span class='fu'>vis_anova_assumptions</span><span class='op'>(</span><span class='va'>iris</span><span class='op'>$</span><span class='va'>Petal.Width</span>,<span class='va'>iris</span><span class='op'>$</span><span class='va'>Species</span><span class='op'>)</span></span>
<span class='r-plt'><img src='vis_anova_assumptions-3.png' alt='' width='700' height='433' /></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $shapiro_test</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 	Shapiro-Wilk normality test</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> data:  rstandard(anova)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> W = 0.97217, p-value = 0.003866</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $ad_test</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 	Anderson-Darling normality test</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> data:  rstandard(anova)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> A = 1.8447, p-value = 9.831e-05</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $summary_anova</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>              Df Sum Sq Mean Sq F value Pr(&gt;F)    </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> fact          2  80.41   40.21     960 &lt;2e-16 ***</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Residuals   147   6.16    0.04                   </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> ---</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> $bartlett_test</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 	Bartlett test of homogeneity of variances</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> data:  samples by fact</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Bartlett's K-squared = 39.213, df = 2, p-value = 3.055e-09</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sabine Schilling.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


